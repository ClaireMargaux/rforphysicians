merged_nhanes$SMQ040 %in% c("Every day", "Some days") ~ "Yes",
merged_nhanes$SMQ040 == "Refused" ~ NA
)
# Let us visualize the contingency table
table(merged_nhanes$SMOKE, merged_nhanes$RIAGENDR)
# Let us visualize the contingency table
table(merged_nhanes$SMOKE)
table(merged_nhanes$RIAGENDR)
table(merged_nhanes$SMOKE, merged_nhanes$RIAGENDR)
# Let us visualize the contingency table
(tab <- table(merged_nhanes$SMOKE, merged_nhanes$RIAGENDR))
# What are the expected cell counts in this case?
chisq <- chisq.test(tab)
round(chisq$expected,2)
# Since all cells are >5, we can test the null hypothesis of independence using
# a chi-squared test
chisq.test(tab)
# Let us also try to run a Fisher's exact test on the same table
fisher.test(tab)
# Load the merged_nhanes CSV file
merged_nhanes <- read.csv("/home/claire/Documents/GitHub/rforphysicians/data_sets/merged_nhanes.csv")
# Load the merged_nhanes_with_mort CSV file
merged_nhanes_with_mort <- read.csv("/home/claire/Documents/GitHub/rforphysicians/data_sets/merged_nhanes_with_mort.csv")
# We quickly check the distribution of the BMI using a Q-Q-plot (even though,
# with such a large sample, this isn't required)
qqnorm(y = merged_nhanes$BMXBMI)
View(merged_nhanes)
# Let us have a look at the distribution of the weight using a Q-Q-plot
qqnorm(y = merged_nhanes$BMXWT)
# Let us have a look at the distribution of the weight using a Q-Q-plot
qqnorm(y = merged_nhanes$BMXWT)
# Let us have a look at the distribution of the weight using a Q-Q-plot
qqnorm(y = merged_nhanes$BMXWT)
# Let us have a look at the distribution of the weight using a Q-Q-plot
qqnorm(y = merged_nhanes$BMXWT)
# Let us have a look at the distribution of the weight using a Q-Q-plot
qqnorm(y = merged_nhanes$BMXBMI)
qqnorm(y = merged_nhanes$BMXHT)
# Let us have a look at the distribution of weight and height with a Q-Q-plot
qqline(y = merged_nhanes$BMXWT)
# Load the merged_nhanes CSV file
merged_nhanes <- read.csv("/home/claire/Documents/GitHub/rforphysicians/data_sets/merged_nhanes.csv")
# Load the merged_nhanes_with_mort CSV file
merged_nhanes_with_mort <- read.csv("/home/claire/Documents/GitHub/rforphysicians/data_sets/merged_nhanes_with_mort.csv")
# Let us have a look at the distribution of weight and height with a Q-Q-plot
qqline(y = merged_nhanes$BMXWT)
# Let us have a look at the distribution of weight and height with a Q-Q-plot
qqline(y = merged_nhanes$BMXWT)
# Let us have a look at the distribution of weight and height with a Q-Q-plot
qqline(y = merged_nhanes$BMXWT, distribution = qnorm)
# Let us have a look at the distribution of weight and height with a Q-Q-plot
qqline(y = merged_nhanes$BMXWT, distribution = qnorm)
# Let us have a look at the distribution of weight and height with a Q-Q-plot
qqnorm(y = merged_nhanes$BMXWT)
qqnorm(y = merged_nhanes$BMXHT)
# Let us have a look at the distribution of weight and height with a Q-Q-plot
qqnorm(y = merged_nhanes$BMXWT)
# Let us have a look at the distribution of weight and height with a Q-Q-plot
qqline(y = merged_nhanes$BMXWT)
# Let us have a look at the distribution of weight and height with a Q-Q-plot
qqline(y = merged_nhanes$BMXWT)
qqline(y = merged_nhanes$BMXHT)
# Let us have a look at the distribution of weight and height with a Q-Q-plot
qqline(y = merged_nhanes$BMXWT)
qqline(y = merged_nhanes$BMXHT)
# Let us have a look at the distribution of weight and height with a Q-Q-plot
qqline(y = merged_nhanes$BMXWT)
qqline(y = merged_nhanes$BMXHT)
# Let us have a look at the distribution of weight and height with a Q-Q-plot
qqline(y = merged_nhanes$BMXWT)
qqline(y = merged_nhanes$BMXHT)
qqnorm(y = merged_nhanes$BMXHT)
# Let us have a look at the distribution of weight and height with a Q-Q-plot
qqline(y = merged_nhanes$BMXWT)
# Let us have a look at the distribution of weight and height with a Q-Q-plot
qqline(y = merged_nhanes$BMXHT)
# Let us have a look at the distribution of weight and height with a Q-Q-plot
qqline(y = merged_nhanes$BMXWT)
# Let us have a look at the distribution of weight and height with a Q-Q-plot
qqline(y = merged_nhanes$BMXWT)
# Let us have a look at the distribution of weight and height with a Q-Q-plot
qqline(y = merged_nhanes$BMXHT)
# Let us have a look at the distribution of weight and height with a Q-Q-plot
qqnorm(y = merged_nhanes$BMXWT)
qqnorm(y = merged_nhanes$BMXHT)
# It would be completely equivalent to use the function qqplot, using a normally
# distributed vector as comparison
qqplot(x = qnorm(ppoints(500)), y = merged_nhanes$BMXWT)
# Let us have a look at the distribution of weight and height with a Q-Q-plot
qqnorm(y = merged_nhanes$BMXWT)
qqnorm(y = merged_nhanes$BMXHT)
# It would be completely equivalent to use the function qqplot, using a normally
# distributed vector as comparison
qqplot(x = qnorm(ppoints(500)), y = merged_nhanes$BMXWT)
qqplot(x = qnorm(ppoints(500)), y = merged_nhanes$BMXHT)
# Let us have a look at the distribution of weight and height with a Q-Q-plot
qqnorm(y = merged_nhanes$BMXWT)
qqnorm(y = merged_nhanes$BMXHT)
# It would be completely equivalent to use the function qqplot, using a normally
# distributed vector as comparison
qqplot(x = qnorm(ppoints(1000)), y = merged_nhanes$BMXWT)
qqplot(x = qnorm(ppoints(1000)), y = merged_nhanes$BMXHT)
# Let us have a look at the distribution of weight and height with a Q-Q-plot
qqnorm(y = merged_nhanes$BMXWT)
qqnorm(y = merged_nhanes$BMXHT)
# It would be completely equivalent to use the function qqplot, using a normally
# distributed vector as comparison
qqplot(x = qnorm(ppoints(1000, a = c(-10,10))), y = merged_nhanes$BMXWT)
qqplot(x = qnorm(ppoints(1000, a = c(-10,10))), y = merged_nhanes$BMXHT)
# Let us have a look at the distribution of weight and height with a Q-Q-plot
qqnorm(y = merged_nhanes$BMXWT)
qqline(y = merged_nhanes$BMXWT, col = "steelblue", lwd = 2)
qqnorm(y = merged_nhanes$BMXHT)
qqline(y = merged_nhanes$BMXWT, col = "steelblue", lwd = 2)
# Let us have a look at the distribution of weight and height with a Q-Q-plot
qqnorm(y = merged_nhanes$BMXWT)
qqline(y = merged_nhanes$BMXWT, col = "steelblue", lwd = 2)
qqnorm(y = merged_nhanes$BMXHT)
qqline(y = merged_nhanes$BMXHT, col = "steelblue", lwd = 2)
# Let us have a look at the distribution of weight and height with a Q-Q-plot
# We use qqline right after qqnorm to add a reference line
qqnorm(y = merged_nhanes$BMXWT)
qqline(y = merged_nhanes$BMXWT, col = "steelblue", lwd = 2)
qqnorm(y = merged_nhanes$BMXHT)
qqline(y = merged_nhanes$BMXHT, col = "steelblue", lwd = 2)
# Let us have a look at the distribution of weight and height with a Q-Q-plot.
# We use qqline right after qqnorm to add a reference line.
qqnorm(y = merged_nhanes$BMXWT)
qqline(y = merged_nhanes$BMXWT, col = "steelblue", lwd = 2, probs = c(0.25, 0.75))
qqnorm(y = merged_nhanes$BMXHT)
qqline(y = merged_nhanes$BMXHT, col = "steelblue", lwd = 2, probs = c(0.25, 0.75))
# We can see that the height is more normally distributed thatn the weight.
# It would be completely equivalent to use the function qqplot, using a normally
# distributed vector as comparison.
qqplot(x = qnorm(ppoints(1000, a = c(-10,10))), y = merged_nhanes$BMXWT)
qqplot(x = qnorm(ppoints(1000, a = c(-10,10))), y = merged_nhanes$BMXHT)
# Let us have a look at the distribution of weight and height with a Q-Q-plot.
# We use qqline right after qqnorm to add a reference line.
qqnorm(y = merged_nhanes$BMXWT)
qqline(y = merged_nhanes$BMXWT, col = "steelblue", lwd = 2, probs = c(0.25, 0.75))
# Let us have a look at the distribution of weight and height with a Q-Q-plot.
qqnorm(y = merged_nhanes$BMXWT)
qqnorm(y = merged_nhanes$BMXHT)
# It would be completely equivalent to use the function qqplot, using a normally
# distributed vector as comparison.
qqplot(x = qnorm(rnorm(100, mean = 0, sd = 1)), y = merged_nhanes$BMXWT)
qqplot(x = qnorm(rnorm(100, mean = 0, sd = 1)), y = merged_nhanes$BMXHT)
# It would be completely equivalent to use the function qqplot, using a normally
# distributed vector as comparison.
qqplot(x = qnorm(rnorm(1000, mean = 0, sd = 1)), y = merged_nhanes$BMXWT)
qqplot(x = qnorm(rnorm(1000, mean = 0, sd = 1)), y = merged_nhanes$BMXHT)
# Let us have a look at the distribution of weight and height with a Q-Q-plot.
qqnorm(y = merged_nhanes$BMXWT)
qqnorm(y = merged_nhanes$BMXHT)
# It would be completely equivalent to use the function qqplot, using a normally
# distributed vector as comparison.
qqplot(x = qnorm(rnorm(10000, mean = 0, sd = 1)), y = merged_nhanes$BMXWT)
qqplot(x = qnorm(rnorm(10000, mean = 0, sd = 1)), y = merged_nhanes$BMXHT)
# Let us have a look at the distribution of weight and height with a Q-Q-plot.
qqnorm(y = merged_nhanes$BMXWT)
qqnorm(y = merged_nhanes$BMXHT)
# We can see that the height is more normally distributed than the weight.
# It would be completely equivalent to use the function qqplot, using a normally
# distributed vector as comparison.
qqplot(x = qnorm(rnorm(10000, mean = 0, sd = 1)), y = merged_nhanes$BMXWT)
qqplot(x = qnorm(rnorm(10000, mean = 0, sd = 1)), y = merged_nhanes$BMXHT)
qqnorm(y = merged_nhanes$BMXHT)
abline(lm(merged_nhanes$BMXHT ~ qnorm(rnorm(10000, mean = 0, sd = 1)), col = "red")
abline(lm(merged_nhanes$BMXHT ~ qnorm(rnorm(10000, mean = 0, sd = 1))), col = "red")
qqnorm(y = merged_nhanes$BMXHT)
abline(lm(merged_nhanes$BMXHT ~ qnorm(rnorm(10000, mean = 0, sd = 1))), col = "red")
# It would be completely equivalent to use the function qqplot, using a normally
# distributed vector as comparison.
qqplot(x = ppoints(1000, a = 0.375), y = merged_nhanes$BMXWT)
qqplot(x = ppoints(1000, a = 0.375), y = merged_nhanes$BMXHT)
# It would be completely equivalent to use the function qqplot, using a normally
# distributed vector as comparison.
qqplot(x = ppoints(100, a = 0.375), y = merged_nhanes$BMXWT)
qqplot(x = ppoints(100, a = 0.375), y = merged_nhanes$BMXHT)
# Let us have a look at the distribution of weight and height with a Q-Q-plot.
qqnorm(y = merged_nhanes$BMXWT)
qqnorm(y = merged_nhanes$BMXHT)
# It would be completely equivalent to use the function qqplot, using a normally
# distributed vector as comparison.
qqplot(x = ppoints(100, a = 0.375), y = merged_nhanes$BMXWT)
qqplot(x = ppoints(100, a = 0.375), y = merged_nhanes$BMXHT)
# It would be completely equivalent to use the function qqplot, using a normally
# distributed vector as comparison.
x <- rnorm(1000)
qqnorm(x * 1.5)
qqplot(x = x, y = merged_nhanes$BMXWT)
qqplot(x = x, y = merged_nhanes$BMXHT)
# Let us have a look at the distribution of weight and height with a Q-Q-plot.
qqnorm(y = merged_nhanes$BMXWT)
qqnorm(y = merged_nhanes$BMXHT)
# Let us have a look at the distribution of weight and height with a Q-Q-plot.
qqnorm(y = merged_nhanes$BMXWT)
qqplot(x = x, y = merged_nhanes$BMXWT)
# It would be completely equivalent to use the function qqplot, using a normally
# distributed vector as comparison.
x <- rnorm(1000)
qqplot(x = x, y = merged_nhanes$BMXWT)
qqplot(x = x, y = merged_nhanes$BMXHT)
# It would be completely equivalent to use the function qqplot, using a normally
# distributed vector as comparison.
x <- rnorm(10000)
qqplot(x = x, y = merged_nhanes$BMXWT)
qqplot(x = x, y = merged_nhanes$BMXHT)
# Let us have a look at the distribution of weight and height with a Q-Q-plot.
qqnorm(y = merged_nhanes$BMXWT)
qqplot(x = x, y = merged_nhanes$BMXWT)
qqplot(x = x, y = merged_nhanes$BMXHT)
qqnorm(y = merged_nhanes$BMXHT)
# Let us have a look at the distribution of weight and height with a Q-Q-plot.
qqnorm(y = merged_nhanes$BMXWT)
qqnorm(y = merged_nhanes$BMXHT)
# We can see that the height is more normally distributed than the weight.
# It would be completely equivalent to use the function qqplot, using a normally
# distributed vector as comparison.
x <- rnorm(10000)
qqplot(x = x, y = merged_nhanes$BMXWT)
qqplot(x = x, y = merged_nhanes$BMXHT)
# Let us have a look at the distribution of weight and height with a Q-Q-plot.
qqnorm(y = merged_nhanes$BMXWT)
qqnorm(y = merged_nhanes$BMXHT)
# Let us have a look at the distribution of weight and height with a Q-Q-plot.
qqnorm(y = merged_nhanes$BMXWT)
qqnorm(y = merged_nhanes$BMXHT)
# Let us have a look at the distribution of weight and height with a Q-Q-plot.
qqnorm(y = merged_nhanes$BMXWT)
qqnorm(y = merged_nhanes$BMXHT)
# Let us have a look at the distribution of weight and height with a Q-Q-plot.
qqnorm(y = merged_nhanes$BMXWT)
qqnorm(y = merged_nhanes$BMXHT)
install.packages("ks.test")
# We perform the Kolmogorov-Smirnov test
ks.test(merged_nhanes$BMXHT, "pnorm")
# We perform the Kolmogorov-Smirnov test on weight and height.
ks.test(merged_nhanes$BMXWT, "pnorm")
# We perform the Kolmogorov-Smirnov test on weight and height.
ks.test(merged_nhanes$BMXWT, "pnorm")
ks.test(merged_nhanes$BMXHT, "pnorm")
install.packages("lillie.test")
library(lillie.test)
library(lillie.test)
# We perform the Lilliefors (Kolmogorov-Smirnov) test on weight and height.
lillie.test(merged_nhanes$BMXWT)
lillie.test(merged_nhanes$BMXHT)
library(lillie.test)
install.packages("lillie.test")
library(lillie.test)
# We perform the Lilliefors (Kolmogorov-Smirnov) test on weight and height.
lillie.test(merged_nhanes$BMXWT)
lillie.test(merged_nhanes$BMXHT)
library(lillie.test)
install.packages("lillie.test")
R.version
install.packages("nortest")
library(nortest)
# We perform the Lilliefors (Kolmogorov-Smirnov) test on weight and height.
lillie.test(merged_nhanes$BMXWT)
lillie.test(merged_nhanes$BMXHT)
# Let us have a look at the distribution of weight and height with a Q-Q-plot.
qqnorm(y = merged_nhanes$BMXWT)
qqnorm(y = merged_nhanes$BMXHT)
# We perform the Kolmogorov-Smirnov test on weight and height, comparing them
# to a standard normal distribution ("pnorm").
ks.test(merged_nhanes$BMXWT, "pnorm")
ks.test(merged_nhanes$BMXHT, "pnorm")
# As expected, those samples are not *standard* normal distributed.
mean_BMXWT <- mean(merged_nhanes$BMXWT)
sd_BMXWT <- sd(merged_nhanes$BMXWT)
ks.test(merged_nhanes$BMXWT, "pnorm", mean_BMXWT, sd_BMXWT)
ks.test(merged_nhanes$BMXWT, "pnorm", mean = mean_BMXWT, sd = sd_BMXWT)
# We perform the Shapiro-Wilk test on weight and height
shapiro.test(merged_nhanes$BMXWT)
shapiro.test(merged_nhanes$BMXHT)
nrow(merged_nhanes$BMXH)
length(merged_nhanes$BMXH)
length(merged_nhanes$BMXHT)
sum(!is.finite(merged_nhanes$BMXWT))
# We perform the Kolmogorov-Smirnov test on weight and height, comparing them
# to a standard normal distribution ("pnorm").
ks.test(merged_nhanes$BMXWT, "pnorm")
ks.test(merged_nhanes$BMXHT, "pnorm")
# As expected, those samples are not *standard* normal distributed.
mean_BMXWT <- mean(merged_nhanes$BMXWT)
sd_BMXWT <- sd(merged_nhanes$BMXWT)
ks.test(merged_nhanes$BMXWT, "pnorm", mean = mean_BMXWT, sd = sd_BMXWT)
# We perform the Kolmogorov-Smirnov test on weight and height, comparing them
# to a standard normal distribution ("pnorm").
ks.test(merged_nhanes$BMXWT, "pnorm")
# As expected, those samples are not *standard* normal distributed.
x <- merged_nhanes$BMXWT
ks.test(merged_nhanes$BMXWT, "pnorm", mean(x), sd(x))
# We perform the Shapiro-Wilk test on weight and height
shapiro.test(merged_nhanes$BMXWT)
# We perform the Lilliefors (Kolmogorov-Smirnov) test on weight and height,
# comparing them to a standard normal distribution.
lillie.test(merged_nhanes$BMXWT)
lillie.test(merged_nhanes$BMXHT)
# As expected, those samples are not *standard* normal distributed.
x <- merged_nhanes$BMXWT
ks.test(x, "pnorm", mean(x), sd(x))
z <- merged_nhanes$BMXHT
ks.test(z, "pnorm", mean(z), sd(z))
# We perform the Lilliefors (Kolmogorov-Smirnov) test on weight and height,
# comparing them to a normal distribution.
lillie.test(merged_nhanes$BMXWT)
lillie.test(merged_nhanes$BMXHT)
ks.test(merged_nhanes$BMXHT, "pnorm")
# We perform the Lilliefors (Kolmogorov-Smirnov) test on weight and height,
# comparing them to a normal distribution.
lillie.test(merged_nhanes$BMXWT)
lillie.test(merged_nhanes$BMXHT)
# Since we have more than 5000 data points, we cannot formally use the S-W
# test on our weight or height; but in order to see how the output would look
# like (/!\ no statistical interpretation possible after that!), let us randomly
# select 5000 values from those variables.
BMXWT_5000 <-  sample(x = merged_nhanes$BMXWT, size = 5000, replace = FALSE)
BMXHT_5000 <-  sample(x = merged_nhanes$BMXHT, size = 5000, replace = FALSE)
# We perform the Shapiro-Wilk test on weight and height
shapiro.test(BMXWT_5000)
shapiro.test(BMXHT_5000)
library(survival)
View(merged_nhanes_with_mort)
survdiff(Surv(time = PERMTH_INT, status = MORTSTAT) ~ SMQ020, data = merged_nhanes_with_mort)
Surv(time = PERMTH_INT, status = MORTSTAT)
PERMTH_INT
merged_nhanes_with_mort$PERMTH_INT
merged_nhanes_with_mort$MORTSTAT
merged_nhanes_with_mort$SMQ020
survdiff(Surv(merged_nhanes_with_mort$PERMTH_INT, merged_nhanes_with_mort$MORTSTAT) ~ merged_nhanes_with_mort$SMQ020)
survdiff(Surv(merged_nhanes_with_mort$PERMTH_INT, merged_nhanes_with_mort$MORTSTAT) ~ merged_nhanes_with_mort$SMQ020, data = merged_nhanes_with_mort[merged_nhanes_with_mort$SMQ020 %in% c("Yes", "No"), ])
survdiff(Surv(PERMTH_INT, MORTSTAT) ~ SMQ020, data merged_nhanes_with_mort[merged_nhanes_with_mort$SMQ020 %in% c("Yes", "No"), ])
merged_nhanes_with_mort$SMQ020
survdiff(Surv(PERMTH_INT, MORTSTAT) ~ SMQ020,
data = merged_nhanes_with_mort[merged_nhanes_with_mort$SMQ020 %in% c("Yes", "No"), ])
# We want to have a look at the survival of people depending on the variable
# SMQ020 (smoked at least 100 cigarettes in life).
# We keep only the responses 'yes' or 'no'.
df <- merged_nhanes_with_mort[merged_nhanes_with_mort$SMQ020 %in% c("Yes", "No"), ]
# We perform the log-rank test.
survdiff(Surv(PERMTH_INT, MORTSTAT) ~ SMQ020, data = df)
# Smoking has (unsurprisingly) an influence on death. To see in which direction
# (let us assume that we don't know), since the log-rank test does not tell
# us that, we draw the KM curve.
fit <- survfit(Surv(PERMTH_INT, MORTSTAT) ~ SMQ020, data = df)
gsurvplot(fit,
data = merged_nhanes_no_outliers,
palette = c("steelblue", "salmon"),
conf.int = TRUE,
xlab = "Time (months)",
ylab = "Survival probability",
ylim = c(0.7, 1),
risk.table = TRUE,
title = "Kaplan–Meier survival curve")
library(survival) # for the log-rank test
library(survminer) # for the KM curve
# We want to have a look at the survival of people depending on the variable
# SMQ020 (smoked at least 100 cigarettes in life).
# We keep only the responses 'yes' or 'no'.
df <- merged_nhanes_with_mort[merged_nhanes_with_mort$SMQ020 %in% c("Yes", "No"), ]
# We perform the log-rank test.
survdiff(Surv(PERMTH_INT, MORTSTAT) ~ SMQ020, data = df)
# Smoking has (unsurprisingly) an influence on death. To see in which direction
# (let us assume that we don't know), since the log-rank test does not tell
# us that, we draw the KM curve.
fit <- survfit(Surv(PERMTH_INT, MORTSTAT) ~ SMQ020, data = df)
gsurvplot(fit,
data = df,
palette = c("steelblue", "salmon"),
conf.int = TRUE,
xlab = "Time (months)",
ylab = "Survival probability",
ylim = c(0.7, 1),
risk.table = TRUE,
title = "Kaplan–Meier survival curve")
library(survival) # for the log-rank test
library(survminer) # for the KM curve
# We want to have a look at the survival of people depending on the variable
# SMQ020 (smoked at least 100 cigarettes in life).
# We keep only the responses 'yes' or 'no'.
df <- merged_nhanes_with_mort[merged_nhanes_with_mort$SMQ020 %in% c("Yes", "No"), ]
# We perform the log-rank test.
survdiff(Surv(PERMTH_INT, MORTSTAT) ~ SMQ020, data = df)
# Smoking has (unsurprisingly) an influence on death. To see in which direction
# (let us assume that we don't know), since the log-rank test does not tell
# us that, we draw the KM curve.
fit <- survfit(Surv(PERMTH_INT, MORTSTAT) ~ SMQ020, data = df)
gsurvplot(fit,
data = df,
palette = c("steelblue", "salmon"),
conf.int = TRUE,
xlab = "Time (months)",
ylab = "Survival probability",
ylim = c(0.7, 1),
risk.table = TRUE,
title = "Kaplan–Meier survival curve")
ggsurvplot(fit,
data = df,
palette = c("steelblue", "salmon"),
conf.int = TRUE,
xlab = "Time (months)",
ylab = "Survival probability",
ylim = c(0.7, 1),
risk.table = TRUE,
title = "Kaplan–Meier survival curve")
ggsurvplot(fit,
data = df,
palette = c("steelblue", "salmon"),
conf.int = TRUE,
xlab = "Time (months)",
ylab = "Survival probability",
ylim = c(0.7, 1),
risk.table = TRUE,
title = "Kaplan–Meier survival curve")
knitr::include_graphics(path = "images/censoring.jpg")
setwd("~/Documents/GitHub/rforphysicians/docs")
knitr::include_graphics(path = "images/censoring.jpg")
knitr::include_graphics(path = "images/censoring.jpg")
(survival_data <- data.frame(
id = 1:6,
time = c(5, 8, 12, 4, 9, 15),   # example times
event = c(1, 0, 1, 1, 0, 1)     # example event status (1 = event, 0 = censored)
))
(survival_data <- data.frame(
id = 1:6,
time = c(5, 8, 12, 4, 9, 15),
event = c(1, 0, 1, 1, 0, 1) # (1 = event, 0 = censored)
))
(survival_data <- data.frame(
id = 1:6,
time = c(7, 7, 8, 3, 6, 6),
event = c(1, 1, 0, 1, 1, 0) # (1 = event, 0 = censored)
))
ggsurvplot(fit,
data = survival_data,
palette = c("steelblue"),
conf.int = TRUE,
xlab = "Time (months)",
ylab = "Survival probability",
ylim = c(0.7, 1),
risk.table = TRUE,
title = "Kaplan–Meier survival curve")
ggsurvplot(fit,
data = survival_data,
palette = c("steelblue"),
conf.int = TRUE,
xlab = "Time (months)",
ylab = "Survival probability",
ylim = c(0.7, 1),
risk.table = TRUE,
title = "Kaplan–Meier survival curve")
# Let us draw the KM curve and look at the number at risk.
library(survival) # for the log-rank test
library(survminer) # for the KM curve
fit <- survfit(Surv(time, event) ~ 1, data = survival_data)
ggsurvplot(fit,
data = survival_data,
palette = c("steelblue"),
conf.int = TRUE,
xlab = "Time (months)",
ylab = "Survival probability",
ylim = c(0.7, 1),
risk.table = TRUE,
title = "Kaplan–Meier survival curve")
(survival_data <- data.frame(
id = 1:6,
time = c(7, 7, 8, 3, 6, 6),
event = c(1, 1, 0, 1, 1, 0) # (1 = event, 0 = censored)
))
ggsurvplot(fit,
data = survival_data,
palette = c("steelblue"),
conf.int = TRUE,
xlab = "Time (months)",
ylab = "Survival probability",
risk.table = TRUE,
title = "Kaplan–Meier survival curve")
ylim = c(0.7, 1),
# Smoking has (unsurprisingly) an influence on death. To see in which direction
# (let us assume that we don't know), since the log-rank test does not tell
# us that, we draw the KM curve.
fit <- survfit(Surv(PERMTH_INT, MORTSTAT) ~ SMQ020, data = df)
ggsurvplot(fit,
data = df,
palette = c("steelblue", "salmon"),
conf.int = TRUE,
xlab = "Time (months)",
ylab = "Survival probability",
ylim = c(0.7, 1),
risk.table = TRUE,
title = "Kaplan–Meier survival curve")
library(survival) # for survfit
library(survminer) # for ggsurvplot
# Let us draw the KM curve and look at the number at risk.
fit <- survfit(Surv(time, event) ~ 1, data = survival_data)
ggsurvplot(fit,
data = survival_data,
palette = c("steelblue"),
conf.int = TRUE,
xlab = "Time (months)",
ylab = "Survival probability",
risk.table = TRUE,
title = "Kaplan–Meier survival curve")
# With these two lines, you can automatically set your WD to your R file location
wd <- dirname(rstudioapi::getActiveDocumentContext()$path)
setwd(wd)
getwd()
# With these two lines, you can automatically set your WD to your R file location
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
