# Count how many people are married in the dataset
# (absolute counts and proportions)
married <- demo %>%
mutate(DMDMARTL = ifelse(DMDMARTL == 1, "married", "other")) %>%
select(DMDMARTL)
# Count how many people are married in the dataset
# (absolute counts and proportions)
married <- demo %>%
mutate(DMDMARTL = ifelse(DMDMARTL =="Married", "married", "other")) %>%
select(DMDMARTL)
table(married)
prop.table(table(married))
table(married)
prop.table(table(married))
# Load the necessary CSV files into data frames
directory <- "C:/GitHub/rforphysicians/data_sets/" # Your files' directory here
demo <- read.csv(paste0(directory,"DEMO_G.csv"))  # Demographics (cycle G = 2011–2012)
bpx  <- read.csv(paste0(directory,"BPX_G.csv"))   # Blood pressure
bmx  <- read.csv(paste0(directory,"BMX_G.csv"))   # Body measures
smq  <- read.csv(paste0(directory,"SMQ_G.csv"))   # Smoking questionnaire
# Or simply set your working directory to "source file location", then you do not even have to precise the directory
# e.g. demo <- read.csv("DEMO_G.csv")
# Chunk 1: setup
knitr::opts_chunk$set(
echo = TRUE,
warning = FALSE,
message = FALSE,
fig.height = 5,
fig.width = 6,
eval = TRUE
)
library(tidyverse)
# Chunk 2
# Load the merged_nhanes CSV file
merged_nhanes <- read.csv("C:/GitHub/rforphysicians/data_sets/merged_nhanes.csv")
# Load the merged_nhanes_with_mort CSV file
merged_nhanes_with_mort <- read.csv("C:/GitHub/rforphysicians/data_sets/merged_nhanes_with_mort.csv")
# Chunk 3
knitr::include_graphics(path = "images/types_of_data.jpg")
setwd("C:/GitHub/rforphysicians/docs")
# Chunk 1: setup
knitr::opts_chunk$set(
echo = TRUE,
warning = FALSE,
message = FALSE,
fig.height = 5,
fig.width = 6,
eval = TRUE
)
library(tidyverse)
# Chunk 2
# Load the merged_nhanes CSV file
merged_nhanes <- read.csv("C:/GitHub/rforphysicians/data_sets/merged_nhanes.csv")
# Load the merged_nhanes_with_mort CSV file
merged_nhanes_with_mort <- read.csv("C:/GitHub/rforphysicians/data_sets/merged_nhanes_with_mort.csv")
# Chunk 3
knitr::include_graphics(path = "images/types_of_data.jpg")
# Chunk 4
# parameters
mu <- 0
sigma <- 1
# significance: tails that are 2.5% each (two-tailed alpha = 0.05)
alpha <- 0.05
lower_cut <- qnorm(alpha/2, mean = mu, sd = sigma)
upper_cut <- qnorm(1 - alpha/2, mean = mu, sd = sigma)
# density data
x <- seq(mu - 4*sigma, mu + 4*sigma, length.out = 1000)
df <- data.frame(x = x, y = dnorm(x, mean = mu, sd = sigma))
# split regions
df_mid   <- df[df$x >  lower_cut & df$x <  upper_cut, ]
df_left  <- df[df$x <= lower_cut, ]
df_right <- df[df$x >= upper_cut, ]
# plot: middle first, tails after (so they sit on top), line on top of everything
ggplot(df, aes(x = x, y = y)) +
geom_area(data = df_mid,   fill = "lightgreen", alpha = 0.6) +   # middle area
geom_area(data = df_left,  fill = "coral",  alpha = 0.8) +   # left tail (on top)
geom_area(data = df_right, fill = "coral",  alpha = 0.8) +   # right tail (on top)
geom_line(size = 1) +
geom_vline(xintercept = c(lower_cut, upper_cut), linetype = "dashed") +
annotate("text", x = lower_cut, y = max(df$y)*0.9, label = sprintf("%.3f", lower_cut), hjust = 1.1) +
annotate("text", x = upper_cut, y = max(df$y)*0.9, label = sprintf("%.3f", upper_cut), hjust = -0.1) +
annotate("text",
x = (lower_cut + upper_cut)/2,
y = max(df$y)*0.5,
label = "95%",
size = 6,
fontface = "bold",
color = "black") +
annotate("text",
x = lower_cut-1,
y = max(df$y)*0.5,
label = "2.5%",
size = 6,
fontface = "bold",
color = "black") +
annotate("text",
x = upper_cut+1,
y = max(df$y)*0.5,
label = "2.5%",
size = 6,
fontface = "bold",
color = "black") +
labs(title = "Standard normal density",
x = "x", y = "Density") +
theme_minimal(base_size = 14)
# Chunk 5
# We quickly check the distribution of the BMI using a Q-Q-plot (even though,
# with such a large sample, this isn't required)
qqnorm(y = merged_nhanes$BMXBMI)
# We will learn more on Q-Q-plots under "Assessments of distribution and normality"
# We create two vectors, with the BMIs of women and men
bmi_women <- merged_nhanes$BMXBMI[merged_nhanes$RIAGENDR == "Female"]
bmi_men <- merged_nhanes$BMXBMI[merged_nhanes$RIAGENDR == "Male"]
# We can start looking at how many non NA entries we have and by computing the means
sum(!is.na(bmi_women));sum(!is.na(bmi_men))
mean(bmi_women, na.rm = TRUE);mean(bmi_men, na.rm = TRUE)
qqplot(x = bmi_women, y = bmi_men)
# We compare their means using a t-test
t.test(x = bmi_women, y = bmi_men, alternative = 'two.sided', var.equal = TRUE, paired = FALSE)
# Chunk 6
# We create two vectors, with the BMIs of women and men
bmi_women <- merged_nhanes$BMXBMI[merged_nhanes$RIAGENDR == "Female"]
bmi_men <- merged_nhanes$BMXBMI[merged_nhanes$RIAGENDR == "Male"]
# We compare their distributions using a Wilcoxon test
wilcox.test(x = bmi_women, y = bmi_men, alternative = 'two.sided', mu = 0, paired = FALSE)
# Chunk 7
# First, let us categorize the participants in smoking and non smoking
table(merged_nhanes$SMQ040)
merged_nhanes$SMOKE <- case_when(
merged_nhanes$SMQ040 == "Not at all" ~ "No",
merged_nhanes$SMQ040 %in% c("Every day", "Some days") ~ "Yes",
merged_nhanes$SMQ040 == "Refused" ~ NA
)
# Let us visualize the contingency table
(tab <- table(merged_nhanes$SMOKE, merged_nhanes$RIAGENDR))
# What are the expected cell counts in this case?
chisq <- chisq.test(tab)
round(chisq$expected,2)
# Since all cells are >5, we can test the null hypothesis of independence using
# a chi-square test
chisq.test(tab)
# Let us also try to run a Fisher's exact test on the same table
fisher.test(tab)
# Chunk 8
# We first define different age groups to compare them to each other
merged_nhanes <- merged_nhanes %>%
mutate(AGE_GROUP = cut(RIDAGEYR, breaks = seq(10, 80, 10)))
# Let us have a look at the mean BP values (1st reading) for those groups
merged_nhanes %>%
group_by(AGE_GROUP) %>%
summarise(
n = n(),
mean_BPXSY1 = mean(BPXSY1, na.rm = TRUE)
)
# Let us now test the means using a one-way ANOVA
oneway.test(BPXSY1 ~ AGE_GROUP, data = merged_nhanes)
# Chunk 9
# We first define different age groups to compare them to each other
merged_nhanes <- merged_nhanes %>%
mutate(AGE_GROUP = cut(RIDAGEYR, breaks = seq(10, 80, 10)))
# Let us have a look at the distributions of the BP values (1st reading) for those groups
ggplot(merged_nhanes, aes(x = AGE_GROUP, y = BPXSY1)) +
geom_boxplot(fill = "steelblue", alpha = 0.7) +
labs(
x = "Age group",
y = "Systolic BP in mmHg",
title = "Blood pressure (1st reading) by age group"
) +
theme_minimal()
# Let us now test the distributions using a Kruskal-Wallis test
kruskal.test(BPXSY1 ~ AGE_GROUP, data = merged_nhanes)
# Chunk 10
# Let us have a look at the distribution of weight and height with a Q-Q-plot.
qqnorm(y = merged_nhanes$BMXWT)
qqnorm(y = merged_nhanes$BMXHT)
# We can see that the height is more normally distributed than the weight,
# even though neither of them show a serious deviation from normality (none
# of them is particularly skewed).
# It would be equivalent to use the function qqplot and take a normally
# distributed vector as comparison.
simulated_normal <- rnorm(10000)
qqplot(x = simulated_normal, y = merged_nhanes$BMXWT)
qqplot(x = simulated_normal, y = merged_nhanes$BMXHT)
# Chunk 11
# We perform the Kolmogorov-Smirnov test on weight and height, comparing them
# to a standard normal distribution ("pnorm"), since we don't know their
# true mean and sd.
ks.test(merged_nhanes$BMXWT, "pnorm")
ks.test(merged_nhanes$BMXHT, "pnorm")
# As expected, those samples are not *standard* normal distributed.
# If we want to compare the sample to a normal distribution with mean and sd
# estimated from the sample, we need to use a Lilliefors test.
# Chunk 12
library(nortest)
# We perform the Lilliefors (Kolmogorov-Smirnov) test on weight and height,
# comparing them to a normal distribution.
lillie.test(merged_nhanes$BMXWT)
lillie.test(merged_nhanes$BMXHT)
# Chunk 13
# Since we have more than 5000 data points, we cannot formally use the S-W
# test on our weight or height; but in order to see how the output would look
# like (/!\ no statistical interpretation possible after that!), let us randomly
# select 5000 values from those variables.
BMXWT_5000 <-  sample(x = merged_nhanes$BMXWT, size = 5000, replace = FALSE)
BMXHT_5000 <-  sample(x = merged_nhanes$BMXHT, size = 5000, replace = FALSE)
# We perform the (statistically invalid) Shapiro-Wilk test on the randomly
# generated n=5000 weight and height.
shapiro.test(BMXWT_5000)
shapiro.test(BMXHT_5000)
# Chunk 14
knitr::include_graphics(path = "images/censoring.jpg")
# Chunk 15
(survival_data <- data.frame(
id = 1:6,
time = c(7, 7, 8, 3, 6, 6),
event = c(1, 1, 0, 1, 1, 0) # (1 = event, 0 = censored)
))
# Chunk 16
library(survival) # for survfit
library(survminer) # for ggsurvplot
# Let us draw the KM curve and look at the number at risk.
fit <- survfit(Surv(time, event) ~ 1, data = survival_data)
ggsurvplot(fit,
data = survival_data,
palette = c("steelblue"),
conf.int = TRUE,
xlab = "Time (months)",
ylab = "Survival probability",
risk.table = TRUE,
title = "Kaplan–Meier survival curve")
# Chunk 17
# We want to have a look at the survival of people depending on the variable
# SMQ020 (smoked at least 100 cigarettes in life).
# We keep only the responses 'yes' or 'no'.
df <- merged_nhanes_with_mort[merged_nhanes_with_mort$SMQ020 %in% c("Yes", "No"), ]
# We perform the log-rank test.
survdiff(Surv(PERMTH_INT, MORTSTAT) ~ SMQ020, data = df)
# Smoking has (unsurprisingly) an influence on death. To see in which direction
# (let us assume that we don't know), since the log-rank test does not tell
# us that, we draw the KM curve.
fit <- survfit(Surv(PERMTH_INT, MORTSTAT) ~ SMQ020, data = df)
ggsurvplot(fit,
data = df,
palette = c("steelblue", "salmon"),
conf.int = TRUE,
xlab = "Time (months)",
ylab = "Survival probability",
ylim = c(0.7, 1),
risk.table = TRUE,
title = "Kaplan–Meier survival curve")
# Chunk 18
# We quickly check the distribution of weight, BMI, height and waist circumference using Q-Q-plots
qqnorm(y = merged_nhanes$BMXWT)
qqnorm(y = merged_nhanes$BMXHT)
qqnorm(y = merged_nhanes$BMXBMI)
qqnorm(y = merged_nhanes$BMXWAIST)
# Let us compute the Pearson's correlation coefficient and test.
# We also plot the each pair of variables in a scatter plot.
cor.test(x = merged_nhanes$BMXWT, y = merged_nhanes$BMXHT, method = c("pearson")) # weight and height circumference
plot(merged_nhanes$BMXWT, merged_nhanes$BMXHT,
col = "steelblue",
xlab = "Weight (kg)",
ylab = "Height (cm)",
main = "Scatterplot of weight vs height")
cor.test(x = merged_nhanes$BMXWT, y = merged_nhanes$BMXWAIST, method = c("pearson")) # weight and waist circumference
plot(x = merged_nhanes$BMXWT, y = merged_nhanes$BMXWAIST,
col = "steelblue",
xlab = "Weight (kg)",
ylab = "Waist circumference (cm)",
main = "Scatterplot of weight vs waist circumference")
cor.test(x = merged_nhanes$BMXHT, y = merged_nhanes$BMXWAIST, method = c("pearson")) # height and waist circumference
plot(x = merged_nhanes$BMXHT, y = merged_nhanes$BMXWAIST,
col = "steelblue",
xlab = "Height (cm)",
ylab = "Waist circumference (cm)",
main = "Scatterplot of height vs waist circumference")
cor.test(x = merged_nhanes$BMXWT, y = merged_nhanes$BMXBMI, method = c("pearson")) # weight and BMI
plot(x = merged_nhanes$BMXWT, y = merged_nhanes$BMXBMI,
col = "steelblue",
xlab = "Weight (kg)",
ylab = "Body Mass Index (kg/m^2)",
main = "Scatterplot of weight vs BMI")
cor.test(x = merged_nhanes$BMXHT, y = merged_nhanes$BMXBMI, method = c("pearson")) # height and BMI
plot(x = merged_nhanes$BMXHT, y = merged_nhanes$BMXBMI,
col = "steelblue",
xlab = "Height (cm)",
ylab = "Body Mass Index (kg/m^2)",
main = "Scatterplot of height vs BMI")
# Chunk 19
# Let us compute the Spearman's correlation coefficient and test.
# We also plot the each pair of variables in a scatter plot.
cor.test(x = merged_nhanes$BMXWT, y = merged_nhanes$BMXHT, method = c("spearman"), exact = FALSE) # weight and height circumference
plot(merged_nhanes$BMXWT, merged_nhanes$BMXHT,
col = "steelblue",
xlab = "Weight (kg)",
ylab = "Height (cm)",
main = "Scatterplot of weight vs height")
cor.test(x = merged_nhanes$BMXWT, y = merged_nhanes$BMXWAIST, method = c("spearman"), exact = FALSE) # weight and waist circumference
plot(x = merged_nhanes$BMXWT, y = merged_nhanes$BMXWAIST,
col = "steelblue",
xlab = "Weight (kg)",
ylab = "Waist circumference (cm)",
main = "Scatterplot of weight vs waist circumference")
cor.test(x = merged_nhanes$BMXHT, y = merged_nhanes$BMXWAIST, method = c("spearman"), exact = FALSE) # height and waist circumference
plot(x = merged_nhanes$BMXHT, y = merged_nhanes$BMXWAIST,
col = "steelblue",
xlab = "Height (cm)",
ylab = "Waist circumference (cm)",
main = "Scatterplot of height vs waist circumference")
cor.test(x = merged_nhanes$BMXWT, y = merged_nhanes$BMXBMI, method = c("spearman"), exact = FALSE) # weight and BMI
plot(x = merged_nhanes$BMXWT, y = merged_nhanes$BMXBMI,
col = "steelblue",
xlab = "Weight (kg)",
ylab = "Body Mass Index (kg/m^2)",
main = "Scatterplot of weight vs BMI")
cor.test(x = merged_nhanes$BMXHT, y = merged_nhanes$BMXBMI, method = c("spearman"), exact = FALSE) # height and BMI
plot(x = merged_nhanes$BMXHT, y = merged_nhanes$BMXBMI,
col = "steelblue",
xlab = "Height (cm)",
ylab = "Body Mass Index (kg/m^2)",
main = "Scatterplot of height vs BMI")
# Chunk 20
# Let us have a look at the systolic blood pressure in our data set
hist(merged_nhanes$BPXSY1,
col = "steelblue",
xlab = "Stystolic blood pressure (1st reading) [mmHg]",
ylab = "Count",
main = "Histogram of systolic blood pressure")
qqnorm(merged_nhanes$BPXSY1,
col = "steelblue",
xlab = "Normal quantiles",
ylab = "Stystolic blood pressure (1st reading) [mmHg]",
main = "Q-Q-plot of systolic blood pressure")
# Since the distribution is only slightly right-skewed, and we have a lot of data, we run a t-test to compare both groups (males and females)
females <- merged_nhanes[merged_nhanes$RIAGENDR == "Female",]$BPXSY1
males <- merged_nhanes[merged_nhanes$RIAGENDR == "Male",]$BPXSY1
t.test(x = females, y = males,
alternative = c("two.sided"))
# The p-value is highly significant (p-value = 1.801e-15)
# If the data had been to skewed, we could have used a Wilcoxon rank-sum test (also called Mann–Whitney U test)
# Chunk 21
# Let us have a look at the waist circumference in our data set
hist(merged_nhanes$DMDHRAGE,
col = "coral",
xlab = "Count",
ylab = "Stystolic blood pressure (1st reading) [mmHg]",
main = "Histogram of systolic blood pressure")
qqnorm(merged_nhanes$DMDHRAGE,
col = "coral",
xlab = "Normal quantiles",
ylab = "Stystolic blood pressure (1st reading) [mmHg]",
main = "Q-Q-plot of systolic blood pressure")
# This time, the distribution is definitely non normal, so we run a Wilcoxon test to compare the smokers and non smokers
smokers <- merged_nhanes[merged_nhanes$SMQ020 == "Yes",]$DMDHRAGE
nonsmokers <- merged_nhanes[merged_nhanes$SMQ020 == "No",]$DMDHRAGE
wilcox.test(x = smokers, y = nonsmokers,
alternative = c("two.sided"))
# The p-value is highly significant (p-value = 4.888e-11)
# Chunk 22
# We are comparing proportions, so we need to determine if we have to use a Chi-square test or a Fisher's exact test
# First, let us select the smokers and non-smokers (and get rid of the categories 'Don't know' and 'Refused') and put the non married people together in one group
smoke <- merged_nhanes[merged_nhanes$SMQ020 %in% c("Yes", "No"),]
smoke$DMDHRMAR <- ifelse(smoke$DMDHRMAR == "Married", "Married", "Not married")
# Let us visualize the contingency table
(tab <- table(smoke$SMQ020, smoke$DMDHRMAR))
# What are the expected cell counts in this case?
chisq <- chisq.test(tab)
round(chisq$expected,2)
# Since the expected counts are way above 5, we use a chi-square test to compare the proportions
chisq.test(tab)
# The p-value is highly significant (p-value = 2.115e-05)
# Chunk 23
# We are again comparing proportions, so we need to determine if we have to use a Chi-square test or a Fisher's exact test
# First, let us select the pipe and cigar smokers
smoke <- merged_nhanes[merged_nhanes$SMQ020 %in% c("Yes", "No"),]
smoke$DMDHRMAR <- ifelse(smoke$DMDHRMAR == "Married", "Married", "Not married")
# Let us visualize the contingency table
(tab <- table(smoke$SMQ020, smoke$DMDHRMAR))
# What are the expected cell counts in this case?
chisq <- chisq.test(tab)
round(chisq$expected,2)
# Since the expected counts are way above 5, we use a chi-square test to compare the proportions
chisq.test(tab)
# The p-value is highly significant (p-value = 2.115e-05)
table(DMDMARTL)
table(merged_nhanes$DMDMARTL)
table(merged_nhanes$RIDEXPRG)
merged_nhanes$RIDEXPRG
table(merged_nhanes$RIDEXPRG)
table(merged_nhanes$RIDEXPRG)
table(merged_nhanes$DMDMARTL)
# First, let us select the marital status and pregancy status
pregnancy_df <- merged_nhanes[merged_nhanes$RIDEXPRG %in%
c("Yes, positive lab pregnancy test or self-reported pregnant at exam",
"The participant was not pregnant at exam"),]
# First, let us select the marital status and pregnancy status
pregnancy_df <- merged_nhanes[merged_nhanes$RIDEXPRG %in%
c("Yes, positive lab pregnancy test or self-reported pregnant at exam",
"The participant was not pregnant at exam"),]
pregnancy_df$DMDMARTL <- ifelse(smoke$DMDHRMAR == "Married" |"Living with partner", "Partner", "No partner")
pregnancy_df$DMDMARTL <- ifelse(smoke$DMDHRMAR  %in% c("Married","Living with partner"),
"Partner", "No partner")
# First, let us select the marital status and pregnancy status
pregnancy_df <- merged_nhanes[merged_nhanes$RIDEXPRG %in%
c("Yes, positive lab pregnancy test or self-reported pregnant at exam",
"The participant was not pregnant at exam"),c("RIDEXPRG","DMDHRMAR")]
pregnancy_df$DMDMARTL <- ifelse(pregnancy_df$DMDHRMAR  %in% c("Married","Living with partner"),
"Partner", "No partner")
# Let us visualize the contingency table
(tab <- table(pregnancy_df$RIDEXPRG, pregnancy_df$DMDHRMAR))
# First, let us select the marital status and pregnancy status
pregnancy_df <- merged_nhanes[merged_nhanes$RIDEXPRG %in%
c("Yes, positive lab pregnancy test or self-reported pregnant at exam",
"The participant was not pregnant at exam"),c("RIDEXPRG","DMDMARTL")]
pregnancy_df$DMDMARTL <- ifelse(pregnancy_df$DMDMARTL  %in% c("Married","Living with partner"),
"Partner", "No partner")
# Let us visualize the contingency table
(tab <- table(pregnancy_df$RIDEXPRG, pregnancy_df$DMDHRMAR))
# First, let us select the marital status and pregnancy status
pregnancy_df <- merged_nhanes[merged_nhanes$RIDEXPRG %in%
c("Yes, positive lab pregnancy test or self-reported pregnant at exam",
"The participant was not pregnant at exam"),c("RIDEXPRG","DMDMARTL")]
pregnancy_df$DMDMARTL <- ifelse(pregnancy_df$DMDMARTL  %in% c("Married","Living with partner"),
"Partner", "No partner")
# Let us visualize the contingency table
(tab <- table(pregnancy_df$RIDEXPRG, pregnancy_df$DMDHRMAR))
pregnancy_df
# First, let us select the marital status and pregnancy status
pregnancy_df <- merged_nhanes[merged_nhanes$RIDEXPRG %in%
c("Yes, positive lab pregnancy test or self-reported pregnant at exam",
"The participant was not pregnant at exam"),c("RIDEXPRG","DMDMARTL")]
pregnancy_df <- ifelse(pregnancy_df$RIDEXPRG  == "Yes, positive lab pregnancy test
or self-reported pregnant at exam",
"Pregnant", "Not pregnant") # Purely cosmetic
pregnancy_df$DMDMARTL <- ifelse(pregnancy_df$DMDMARTL  %in% c("Married","Living with partner"),
"Partner", "No partner")
pregnancy_df
# First, let us select the marital status and pregnancy status
pregnancy_df <- merged_nhanes[merged_nhanes$RIDEXPRG %in%
c("Yes, positive lab pregnancy test or self-reported pregnant at exam",
"The participant was not pregnant at exam"),c("RIDEXPRG","DMDMARTL")]
pregnancy_df$RIDEXPRG <- ifelse(pregnancy_df$RIDEXPRG  == "Yes, positive lab pregnancy test
or self-reported pregnant at exam",
"Pregnant", "Not pregnant") # Purely cosmetic
pregnancy_df$DMDMARTL <- ifelse(pregnancy_df$DMDMARTL  %in% c("Married","Living with partner"),
"Partner", "No partner")
head(pregnancy_df)
# Let us visualize the contingency table
(tab <- table(pregnancy_df$RIDEXPRG, pregnancy_df$DMDHRMAR))
# Let us visualize the contingency table
(tab <- table(pregnancy_df))
# First, let us select the marital status and pregnancy status
pregnancy_df <- merged_nhanes[merged_nhanes$RIDEXPRG %in%
c("Yes, positive lab pregnancy test or self-reported pregnant at exam",
"The participant was not pregnant at exam"),c("RIDEXPRG","DMDMARTL")]
View(pregnancy_df)
# First, let us select the marital status and pregnancy status
pregnancy_df <- merged_nhanes[merged_nhanes$RIDEXPRG %in%
c("Yes, positive lab pregnancy test or self-reported pregnant at exam",
"The participant was not pregnant at exam"),c("RIDEXPRG","DMDMARTL")]
pregnancy_df$RIDEXPRG <- ifelse(pregnancy_df$RIDEXPRG  == "Yes, positive lab pregnancy test or self-reported pregnant at exam", "Pregnant", "Not pregnant") # Purely cosmetic
pregnancy_df$DMDMARTL <- ifelse(pregnancy_df$DMDMARTL  %in% c("Married","Living with partner"),
"Partner", "No partner")
# Let us visualize the contingency table
(tab <- table(pregnancy_df))
# What are the expected cell counts in this case?
chisq <- chisq.test(tab)
round(chisq$expected,2)
# Since the expected counts are way above 5, we use a chi-square test to compare the proportions
chisq.test(tab)
# Let us visualize the contingency table
(tab <- table(pregnancy_df))
head(merged_nhanes$AGE_GROUP)
# Let us have a look at the mean BMI for those groups
merged_nhanes %>%
group_by(AGE_GROUP) %>%
summarise(
n = n(),
mean_BMXBMI = mean(BMXBMI, na.rm = TRUE)
)
# Let us now test the means using a one-way ANOVA
oneway.test(BMXBMI ~ AGE_GROUP, data = merged_nhanes)
# Let us have a look at the distribution of the BMI for those groups
BMI_df <- merged_nhanes[,c("AGE_GROUP", "BMXBMI")]
seq(10, 80, 10)
AGE_GROUP = cut(RIDAGEYR, breaks = seq(10, 80, 10))
factor(BMI_df$AGE_GROUP)
sapply(BMI_df$AGE_GROUP, levels)
levels(BMI_df$AGE_GROUP)
qqnorm(BMI_df$AGE_GROUP == i)
for(i in levels(BMI_df$AGE_GROUP)){
qqnorm(BMI_df$AGE_GROUP == i)
} # using a for loop to win some space
BMI_df
qqnorm(BMI_df$BMXBMI[BMI_df$AGE_GROUP == i])
for(i in levels(BMI_df$AGE_GROUP)){
qqnorm(BMI_df$BMXBMI[BMI_df$AGE_GROUP == i])
} # using a for loop to win some space
for(i in levels(BMI_df$AGE_GROUP)){
qqnorm(BMI_df$BMXBMI[BMI_df$AGE_GROUP == i])
} # using a for loop to win some space
# Let us now test the means using a one-way ANOVA
oneway.test(BMXBMI ~ AGE_GROUP, data = BMI_df)
# The p-value is highly significant (p-value < 2.2e-16)
# If we are unsure about the use of the ANOVA, we can still try to run a
# If we are unsure about the use of the ANOVA, we can still try to run a
# Kruskal-Wallis test
kruskal.test((BMXBMI ~ AGE_GROUP, data = BMI_df)
# If we are unsure about the use of the ANOVA, we can still try to run a
# Kruskal-Wallis test
kruskal.test(BMXBMI ~ AGE_GROUP, data = BMI_df)
levels(BMI_df$AGE_GROUP)
