sds[i] <- sd(group_data)
ns[i] <- length(group_data)
lowers[i] <- means[i] - 1.96 * sds[i] / sqrt(ns[i])
uppers[i] <- means[i] + 1.96 * sds[i] / sqrt(ns[i])
gender_labels[i] <- genders
}
# Prepare the table text for the forest plot
tabletext <- cbind(
c("Gender", gender_labels),
c("Mean systolic BP", sprintf("%.1f", means))
)[-1, ]
tabletext
genders
(gender_table <- table(merged_nhanes$RIAGENDR))
pie(x = gender_table,
labels = c("Female", "Male"),
col = c("skyblue", "salmon"),
main = "Gender Distribution")
# Calculate summary statistics by gender
genders <- unique(merged_nhanes$RIAGENDR)
means <- numeric(length(genders))
sds <- numeric(length(genders))
ns <- numeric(length(genders))
lowers <- numeric(length(genders))
uppers <- numeric(length(genders))
gender_labels <- character(length(genders))
gender_labels
genders
genders
for (i in seq_along(genders)) {
group_data <- merged_nhanes$BPXSY1[merged_nhanes$RIAGENDR == genders[i]]
group_data <- group_data[!is.na(group_data)]
means[i] <- mean(group_data)
sds[i] <- sd(group_data)
ns[i] <- length(group_data)
lowers[i] <- means[i] - 1.96 * sds[i] / sqrt(ns[i])
uppers[i] <- means[i] + 1.96 * sds[i] / sqrt(ns[i])
gender_labels[i] <- genders
}
gender_labels
merged_nhanes$BPXSY1[merged_nhanes$RIAGENDR == genders[1]
merged_nhanes$BPXSY1[merged_nhanes$RIAGENDR == genders[1]]
merged_nhanes$BPXSY1[merged_nhanes$RIAGENDR == genders[1]]
merged_nhanes$BPXSY1[merged_nhanes$RIAGENDR == genders[2]]
for (i in seq_along(genders)) {
group_data <- merged_nhanes$BPXSY1[merged_nhanes$RIAGENDR == genders[i]]
group_data <- group_data[!is.na(group_data)]
means[i] <- mean(group_data)
sds[i] <- sd(group_data)
ns[i] <- length(group_data)
lowers[i] <- means[i] - 1.96 * sds[i] / sqrt(ns[i])
uppers[i] <- means[i] + 1.96 * sds[i] / sqrt(ns[i])
gender_labels[i] <- genders[i]
}
# Prepare the table text for the forest plot
tabletext <- cbind(
c("Gender", gender_labels),
c("Mean systolic BP", sprintf("%.1f", means))
)[-1, ]
tabletext
library(forestplot)
# Calculate summary statistics by gender
genders <- unique(merged_nhanes$RIAGENDR)
means <- numeric(length(genders))
sds <- numeric(length(genders))
ns <- numeric(length(genders))
lowers <- numeric(length(genders))
uppers <- numeric(length(genders))
gender_labels <- character(length(genders))
for (i in seq_along(genders)) {
group_data <- merged_nhanes$BPXSY1[merged_nhanes$RIAGENDR == genders[i]]
group_data <- group_data[!is.na(group_data)]
means[i] <- mean(group_data)
sds[i] <- sd(group_data)
ns[i] <- length(group_data)
lowers[i] <- means[i] - 1.96 * sds[i] / sqrt(ns[i])
uppers[i] <- means[i] + 1.96 * sds[i] / sqrt(ns[i])
gender_labels[i] <- genders[i]
}
# Prepare the table text for the forest plot
tabletext <- cbind(
c("Gender", gender_labels),
c("Mean systolic BP", sprintf("%.1f", means))
)[-1, ]
# Create the forest plot
forestplot(labeltext = tabletext,
mean = means,
lower = lowers,
upper = uppers,
zero = 120,
xlog = FALSE,
boxsize = 0.2,
col = fpColors(box = "steelblue", line = "steelblue"),
title = "Systolic BP by gender")
library(forestplot)
# Calculate summary statistics by gender
genders <- unique(merged_nhanes$RIAGENDR)
means <- numeric(length(genders))
sds <- numeric(length(genders))
ns <- numeric(length(genders))
lowers <- numeric(length(genders))
uppers <- numeric(length(genders))
gender_labels <- character(length(genders))
for (i in seq_along(genders)) {
group_data <- merged_nhanes$BPXSY1[merged_nhanes$RIAGENDR == genders[i]]
group_data <- group_data[!is.na(group_data)]
means[i] <- mean(group_data)
sds[i] <- sd(group_data)
ns[i] <- length(group_data)
lowers[i] <- means[i] - 1.96 * sds[i] / sqrt(ns[i])
uppers[i] <- means[i] + 1.96 * sds[i] / sqrt(ns[i])
gender_labels[i] <- genders[i]
}
# Prepare the table text for the forest plot
tabletext <- cbind(
c("Gender", gender_labels),
c("Mean systolic BP", sprintf("%.1f", means))
)[-1, ]
# Create the forest plot
forestplot(labeltext = tabletext,
mean = means,
lower = lowers,
upper = uppers,
zero = 120,
col = fpColors(box = "steelblue", line = "steelblue"),
title = "Systolic BP by gender")
# Create the forest plot
forestplot(labeltext = tabletext,
mean = means,
lower = lowers,
upper = uppers,
zero = 120,
boxsize = 0.2,
col = fpColors(box = "steelblue", line = "steelblue"),
title = "Systolic BP by gender")
# Create the forest plot
forestplot(labeltext = tabletext,
mean = means,
lower = lowers,
upper = uppers,
zero = 120,
col = fpColors(box = "steelblue", line = "steelblue"),
title = "Systolic BP by gender")
# Create the forest plot
forestplot(labeltext = tabletext,
mean = means,
lower = lowers,
upper = uppers,
zero = 120,
xlab = "Systolic BP [mmHg]"
col = fpColors(box = "steelblue", line = "steelblue"),
# Create the forest plot
forestplot(labeltext = tabletext,
mean = means,
lower = lowers,
upper = uppers,
zero = 120,
xlab = "Systolic BP [mmHg]",
col = fpColors(box = "steelblue", line = "steelblue"),
title = "Systolic BP by gender")
mean
means
tabletext
# Create the forest plot
forestplot(
mean = means,
lower = lowers,
upper = uppers,
zero = 120,
xlab = "Systolic BP [mmHg]",
col = fpColors(box = "steelblue", line = "steelblue"),
title = "Systolic BP by gender")
# Create the forest plot
forestplot(labeltext = c("male","female"),
mean = means,
lower = lowers,
upper = uppers,
zero = 120,
xlab = "Systolic BP [mmHg]",
col = fpColors(box = "steelblue", line = "steelblue"),
title = "Systolic BP by gender")
# Create the forest plot
forestplot(labeltext = c("Male","Female"),
mean = means,
lower = lowers,
upper = uppers,
zero = 120,
xlab = "Systolic BP [mmHg]",
col = fpColors(box = "steelblue", line = "steelblue"),
title = "Systolic BP by gender")
library(forestplot)
# Calculate summary statistics by gender
genders <- unique(merged_nhanes$RIAGENDR)
means <- numeric(length(genders))
sds <- numeric(length(genders))
ns <- numeric(length(genders))
lowers <- numeric(length(genders))
uppers <- numeric(length(genders))
gender_labels <- character(length(genders))
for (i in seq_along(genders)) {
group_data <- merged_nhanes$BPXSY1[merged_nhanes$RIAGENDR == genders[i]]
group_data <- group_data[!is.na(group_data)]
means[i] <- mean(group_data)
sds[i] <- sd(group_data)
ns[i] <- length(group_data)
lowers[i] <- means[i] - 1.96 * sds[i] / sqrt(ns[i])
uppers[i] <- means[i] + 1.96 * sds[i] / sqrt(ns[i])
gender_labels[i] <- genders[i]
}
# Create the forest plot
forestplot(labeltext = c("Male","Female"),
mean = means,
lower = lowers,
upper = uppers,
zero = 120,
xlab = "Systolic BP [mmHg]",
col = fpColors(box = "steelblue", line = "steelblue"),
title = "Systolic BP by gender")
# Create the forest plot
forestplot(labeltext = c("Male","Female"),
mean = means,
lower = lowers,
upper = uppers,
zero = 120,
is.summary = TRUE,
xlab = "Systolic BP [mmHg]",
col = fpColors(box = "steelblue", line = "steelblue"),
title = "Systolic BP by gender")
# Create the forest plot
forestplot(labeltext = c("Male","Female"),
mean = means,
lower = lowers,
upper = uppers,
zero = 120,
is.summary = FALSE*,
# Create the forest plot
forestplot(labeltext = c("Male","Female"),
mean = means,
lower = lowers,
upper = uppers,
zero = 120,
is.summary = FALSE,
xlab = "Systolic BP [mmHg]",
col = fpColors(box = "steelblue", line = "steelblue"),
title = "Systolic BP by gender")
# Create the forest plot
forestplot(labeltext = c("Male","Female"),
mean = means,
lower = lowers,
upper = uppers,
zero = 120,
grid = TRUE,
xlab = "Systolic BP [mmHg]",
col = fpColors(box = "steelblue", line = "steelblue"),
title = "Systolic BP by gender")
# Create the forest plot
forestplot(labeltext = c("Male","Female"),
mean = means,
lower = lowers,
upper = uppers,
zero = 120,
grid = TRUE,
ci.vertices = TRUE,
xlab = "Systolic BP [mmHg]",
col = fpColors(box = "steelblue", line = "steelblue"),
title = "Systolic BP by gender")
# Create the forest plot
forestplot(labeltext = c("Male","Female"),
mean = means,
lower = lowers,
upper = uppers,
zero = 120,
grid = TRUE,
ci.vertices = TRUE,
ci.vertices.height = 0.1,
xlab = "Systolic BP [mmHg]",
col = fpColors(box = "steelblue", line = "steelblue"),
title = "Systolic BP by gender")
# Create the forest plot
forestplot(labeltext = c("Male","Female"),
mean = means,
lower = lowers,
upper = uppers,
zero = 120,
grid = TRUE,
ci.vertices = TRUE,
ci.vertices.height = 0.01,
xlab = "Systolic BP [mmHg]",
col = fpColors(box = "steelblue", line = "steelblue"),
title = "Systolic BP by gender")
# Create the forest plot
forestplot(labeltext = c("Male","Female"),
mean = means,
lower = lowers,
upper = uppers,
zero = 120,
grid = TRUE,
ci.vertices = TRUE,
ci.vertices.height = 0.05,
xlab = "Systolic BP [mmHg]",
col = fpColors(box = "steelblue", line = "steelblue"),
title = "Systolic BP by gender")
# Create the forest plot
forestplot(labeltext = c("Male","Female"),
mean = means,
lower = lowers,
upper = uppers,
zero = 120,
grid = TRUE,
ci.vertices = TRUE,
ci.vertices.height = 0.03,
xlab = "Systolic BP [mmHg]",
col = fpColors(box = "steelblue", line = "steelblue"),
title = "Systolic BP by gender")
# Create the forest plot
forestplot(labeltext = c("Male","Female"),
mean = means,
lower = lowers,
upper = uppers,
zero = 120,
grid = TRUE,
ci.vertices = TRUE,
xlab = "Systolic BP [mmHg]",
col = fpColors(box = "steelblue", line = "steelblue"),
title = "Systolic BP by gender")
knitr::include_graphics(path = "images/ggplot2-structure.png")
getwd
getwd()
setwd("~/Documents/GitHub/rforphysicians/docs")
knitr::include_graphics(path = "images/ggplot2-structure.png")
knitr::include_graphics(path = "images/ggplot2-structure.png")
knitr::include_graphics(path = "images/ggplot2-structure.png")
# Chunk 1: setup
knitr::opts_chunk$set(
echo = TRUE,
warning = FALSE,
message = FALSE,
fig.height = 5,
fig.width = 6,
eval = TRUE
)
library(ggplot2)
# Chunk 2
# Load the merged_nhanes CSV file
merged_nhanes <- read.csv("/home/claire/Documents/GitHub/rforphysicians/data_sets/merged_nhanes.csv")
# Chunk 3
plot(x = merged_nhanes$RIDAGEYR, y = merged_nhanes$BPXSY1,
xlab = "Age of participant [years]",
ylab = "Systolic blood pressure (1st reading) [mmHg]",
main = "Scatterplot of age vs. systolic BP",
col = c("steelblue"))
# Chunk 4
boxplot(merged_nhanes$BPXSY1 ~ merged_nhanes$RIAGENDR,
names = c("Male", "Female"),
xlab = "Gender",
ylab = "Systolic blood pressure (1st reading) [mmHg]",
main = "Boxplot of BP by gender",
col = c("salmon", "skyblue"))
# Chunk 5
# We define the age groups in which to calculate the mean systolic blood pressure
age_groups <- cut(x = merged_nhanes$RIDAGEYR, breaks = seq(10, 80, 10))
head(age_groups)
# We calculate the mean systolic blood pressure by age group
(avg_bp <- tapply(X = merged_nhanes$BPXSY1, INDEX = age_groups, FUN = mean, na.rm = TRUE))
barplot(avg_bp,
xlab = "Age group [years]",
ylab = "Average systolic BP [mmHg]",
main = "Bar plot of average systolic BP by age group",
col = "steelblue")
# Chunk 6
hist(merged_nhanes$BMXBMI,
breaks = 30,
freq = FALSE,
col = "steelblue",
xlab = "Body Mass Index (BMI)",
main = "Histogram of BMI")
# Chunk 7
# We define the age groups in which to calculate the mean systolic blood pressure
age_groups <- cut(x = merged_nhanes$RIDAGEYR, breaks = seq(10, 80, 10))
head(age_groups)
# We calculate the mean systolic blood pressure by age group
(avg_bp <- tapply(X = merged_nhanes$BPXSY1, INDEX = age_groups, FUN = mean, na.rm = TRUE))
# We define the midpoints of the intervals
midpoints <- seq(15, 75, 10)
plot(midpoints, avg_bp, type = "b",
xlab = "Age (midpoint of group) [years]",
ylab = "Average systolic BP [mmHg]",
main = "Average systolic BP by age group",
col = "steelblue")
# Chunk 8
(gender_table <- table(merged_nhanes$RIAGENDR))
pie(x = gender_table,
labels = c("Female", "Male"),
col = c("skyblue", "salmon"),
main = "Gender Distribution")
# Chunk 9
(smoking_gender_table <- table(merged_nhanes$RIAGENDR, merged_nhanes$SMQ020))
mosaicplot(smoking_gender_table[,c("Yes","No")], # we select only the 'yes/no' answers
main = "Smoking status by gender",
xlab = "Gender",
ylab = "Smoked at least 100 cigarettes?",
col = c("steelblue"))
# Chunk 10
library(forestplot)
# Calculate summary statistics by gender
genders <- unique(merged_nhanes$RIAGENDR)
means <- numeric(length(genders))
sds <- numeric(length(genders))
ns <- numeric(length(genders))
lowers <- numeric(length(genders))
uppers <- numeric(length(genders))
gender_labels <- character(length(genders))
for (i in seq_along(genders)) {
group_data <- merged_nhanes$BPXSY1[merged_nhanes$RIAGENDR == genders[i]]
group_data <- group_data[!is.na(group_data)]
means[i] <- mean(group_data)
sds[i] <- sd(group_data)
ns[i] <- length(group_data)
lowers[i] <- means[i] - 1.96 * sds[i] / sqrt(ns[i])
uppers[i] <- means[i] + 1.96 * sds[i] / sqrt(ns[i])
gender_labels[i] <- genders[i]
}
# Create the forest plot
forestplot(labeltext = c("Male","Female"),
mean = means,
lower = lowers,
upper = uppers,
zero = 120,
grid = TRUE,
ci.vertices = TRUE,
xlab = "Systolic BP [mmHg]",
col = fpColors(box = "steelblue", line = "steelblue"),
title = "Systolic BP by gender")
knitr::include_graphics(path = "images/ggplot2-structure.png")
ggplot(merged_nhanes, aes(x = factor(RIAGENDR, labels = c("Male", "Female")), y = BPXSY1, fill = factor(RIAGENDR))) +
geom_boxplot() +
scale_fill_manual(values = c("salmon", "skyblue")) +
labs(title = "Blood Pressure by Gender",
x = "Gender",
y = "Systolic blood pressure (1st reading)") +
theme_minimal() +
theme(legend.position = "none")
merged_nhanes$RIAGENDR
str(merged_nhanes$RIAGENDR)
factor(merged_nhanes$RIAGENDR)
ggplot(merged_nhanes, aes(x = factor(RIAGENDR, labels = c("Male", "Female")), y = BPXSY1, fill = factor(RIAGENDR))) +
geom_boxplot() +
scale_fill_manual(values = c("salmon", "skyblue")) +
labs(title = "Systolic BP by gender",
x = "Gender",
y = "Systolic BP (1st reading) [mmHg]") +
theme_minimal() +
theme(legend.position = "none")
ggplot(merged_nhanes, aes(x = factor(RIAGENDR, labels = c("Male", "Female")), y = BPXSY1, fill = factor(RIAGENDR))) +
geom_boxplot() +
scale_fill_manual(values = c("salmon", "skyblue")) +
labs(title = "Systolic BP by gender",
x = "Gender",
y = "Systolic BP (1st reading) [mmHg]") +
theme_minimal()
ggplot(merged_nhanes, aes(x = factor(RIAGENDR, labels = c("Male", "Female")), y = BPXSY1, fill = factor(RIAGENDR))) +
geom_boxplot() +
scale_fill_manual(values = c("salmon", "skyblue")) +
labs(title = "Systolic BP by gender",
x = "Gender",
y = "Systolic BP (1st reading) [mmHg]") +
theme_minimal() +
theme(legend.position = "none")
ggplot(merged_nhanes) +
geom_boxplot(aes(x = factor(RIAGENDR, labels = c("Male", "Female")), y = BPXSY1, fill = factor(RIAGENDR))) +
scale_fill_manual(values = c("salmon", "skyblue")) +
labs(title = "Systolic BP by gender",
x = "Gender",
y = "Systolic BP (1st reading) [mmHg]") +
theme_minimal() +
theme(legend.position = "none")
# Create age groups
merged_nhanes$age_group <- cut(merged_nhanes$RIDAGEYR, breaks = seq(10, 80, 10))
# Compute the mean systolic BP per age group using aggregate
avg_bp <- aggregate(BPXSY1 ~ age_group, data = merged_nhanes, FUN = function(x) mean(x, na.rm = TRUE))
ggplot(avg_bp, aes(x = age_group, y = BPXSY1)) +
geom_bar(stat = "identity", fill = "steelblue") +
labs(title = "Average Systolic BP by Age Group",
x = "Age group",
y = "Average Systolic BP") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
# We define the age groups in which to calculate the mean systolic blood pressure
age_groups <- cut(x = merged_nhanes$RIDAGEYR, breaks = seq(10, 80, 10))
head(age_groups)
# Compute the mean systolic BP per age group using aggregate
avg_bp <- aggregate(BPXSY1 ~ age_group, data = merged_nhanes, FUN = function(x) mean(x, na.rm = TRUE))
ggplot(avg_bp, aes(x = age_group, y = BPXSY1)) +
geom_bar(stat = "identity", fill = "steelblue") +
labs(title = "Mean systolic BP by age group",
x = "Age group [years]",
y = "Mean systolic BP [mmHg]") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
# We define the age groups in which to calculate the mean systolic blood pressure
age_groups <- cut(x = merged_nhanes$RIDAGEYR, breaks = seq(10, 80, 10))
head(age_groups)
# We calculate the mean systolic blood pressure by age group
(avg_bp <- aggregate(BPXSY1 ~ age_group, data = merged_nhanes, FUN = function(x) mean(x, na.rm = TRUE)))
barplot(avg_bp,
xlab = "Age group [years]",
ylab = "Average systolic BP [mmHg]",
main = "Bar plot of average systolic BP by age group",
col = "steelblue")
(avg_bp <- aggregate(BPXSY1 ~ age_group, data = merged_nhanes, FUN = function(x) mean(x, na.rm = TRUE)))
# We calculate the mean systolic blood pressure by age group
(avg_bp <- tapply(X = merged_nhanes$BPXSY1, INDEX = age_groups, FUN = mean, na.rm = TRUE))
