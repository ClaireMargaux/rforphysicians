width = 8, height = 6, units = "in", res = 300)
# Create plot
plot(m.out2, type = "jitter", interactive = FALSE)
# Close device
dev.off()
# Open PNG device
png(filename = file.path(directory_results, "matchit_density_plot_1.png"),
width = 8, height = 6, units = "in", res = 300)
# Create plot
plot(m.out2, type = "jitter", interactive = FALSE)
plot(m.out2, type = "jitter", interactive = FALSE)
# Open PNG device
png(filename = file.path(directory_results, "matchit_absolute_mean_diff.png"),
width = 8, height = 6, units = "in", res = 300)
# Create plot
plot(summary(m.out2))
# Close device
dev.off()
# Open PNG device
png(filename = file.path(directory_results, "matchit_distribution.png"),
width = 8, height = 6, units = "in", res = 300)
# Create plot
plot(m.out2, type = "jitter", interactive = FALSE)
# Close device
dev.off()
# Open PNG device
png(filename = file.path(directory_results, "matchit_density_plot_1.png"),
width = 8, height = 6, units = "in", res = 300)
# Create plot
plot(
m.out2,
type = "density",
interactive = FALSE,
which.xs = ~postmri_residual_enhanc_tumor + adjth_type
)
# Close device
dev.off()
# Open PNG device
png(filename = file.path(directory_results, "matchit_density_plot_2.png"),
width = 8, height = 6, units = "in", res = 300)
# Create plot
plot(
m.out2,
type = "density",
interactive = FALSE,
which.xs = ~age_at_surg + mgmt_promotor_methylation
)
# Close device
dev.off()
data$Gruppen <- factor(data$Gruppen,
levels = c(1, 2, 3),
labels = c("RT", "IT/TT + RT", "IT/TT"))
data %>% count(Gruppen)
# Load the merged_nhanes CSV file
merged_nhanes <- read.csv("C:/GitHub/rforphysicians/data_sets/merged_nhanes.csv")
# Load the merged_nhanes_with_mort CSV file
merged_nhanes_with_mort <- read.csv("C:/GitHub/rforphysicians/data_sets/merged_nhanes_with_mort.csv")
# We quickly check the distribution of weight, BMI, height and waist circumference using Q-Q-plots
qqnorm(y = merged_nhanes$BMXWT)
qqnorm(y = merged_nhanes$BMXHT)
qqnorm(y = merged_nhanes$BMXBMI)
qqnorm(y = merged_nhanes$BMXWAIST)
# We see that height and waist circumference are pretty normally distributed, whereas weight and BMI as slightly skewed. Let us compute the correlation coefficients by Pearson and test them.
cor.test(x = merged_nhanes$BMXHT, merged_nhanes$BMXWAIST)
cor.test(x = merged_nhanes$BMXWT, merged_nhanes$BMXBMI)
cor.test(x = merged_nhanes$BMXWT, merged_nhanes$BMXBMI) # weight and BMI
cor.test(x = merged_nhanes$BMXHT, merged_nhanes$BMXBMI) # height and BMI
cor.test(x = merged_nhanes$BMXHT, merged_nhanes$BMXBMI) # height and BMI
# We see that height and waist circumference are pretty normally distributed, whereas weight and BMI as slightly skewed. Let us compute the correlation coefficients by Pearson and test them.
cor.test(x = merged_nhanes$BMXHT, merged_nhanes$BMXWAIST) # height and waist circumference
cor.test(x = merged_nhanes$BMXWT, merged_nhanes$BMXBMI) # weight and BMI
cor.test(x = merged_nhanes$BMXHT, merged_nhanes$BMXBMI) # height and BMI
cor.test(x = merged_nhanes$BMXWT, merged_nhanes$BMXWAIST, method = c("pearson")) # height and waist circumference
# We see that height and waist circumference are pretty normally distributed, whereas weight and BMI as slightly skewed. Let us still compute the Pearson's correlation coefficient and test.
cor.test(x = merged_nhanes$BMXWT, merged_nhanes$BMXHT, method = c("pearson")) # weight and height circumference
# We see that height and waist circumference are pretty normally distributed, whereas weight and BMI as slightly skewed. Let us still compute the Pearson's correlation coefficient and test.
cor.test(x = merged_nhanes$BMXWT, merged_nhanes$BMXHT, method = c("pearson")) # weight and height circumference
cor.test(x = merged_nhanes$BMXWT, merged_nhanes$BMXWAIST, method = c("pearson")) # weight and waist circumference
cor.test(x = merged_nhanes$BMXHT, merged_nhanes$BMXWAIST, method = c("pearson")) # height and waist circumference
cor.test(x = merged_nhanes$BMXWT, merged_nhanes$BMXBMI, method = c("pearson")) # weight and BMI
cor.test(x = merged_nhanes$BMXHT, merged_nhanes$BMXBMI, method = c("pearson")) # height and BMI
# We see that height and waist circumference are pretty normally distributed, whereas weight and BMI as slightly skewed. Let us still compute the Pearson's correlation coefficient and test.
cor.test(x = merged_nhanes$BMXWT, merged_nhanes$BMXHT, method = c("pearson")) # weight and height circumference
# Let us compute the Spearman's correlation coefficient and test.
cor.test(x = merged_nhanes$BMXWT, merged_nhanes$BMXHT, method = c("spearman")) # weight and height circumference
cor.test(x = merged_nhanes$BMXWT, merged_nhanes$BMXWAIST, method = c("spearman")) # weight and waist circumference
cor.test(x = merged_nhanes$BMXHT, merged_nhanes$BMXWAIST, method = c("spearman")) # height and waist circumference
# Let us compute the Spearman's correlation coefficient and test.
cor.test(x = merged_nhanes$BMXWT, merged_nhanes$BMXHT, method = c("spearman"), exact = FALSE) # weight and height circumference
# Let us compute the Spearman's correlation coefficient and test.
cor.test(x = merged_nhanes$BMXWT, merged_nhanes$BMXHT, method = c("spearman"), exact = FALSE) # weight and height circumference
cor.test(x = merged_nhanes$BMXWT, merged_nhanes$BMXWAIST, method = c("spearman"), exact = FALSE) # weight and waist circumference
cor.test(x = merged_nhanes$BMXHT, merged_nhanes$BMXWAIST, method = c("spearman"), exact = FALSE) # height and waist circumference
cor.test(x = merged_nhanes$BMXWT, merged_nhanes$BMXBMI, method = c("spearman"), exact = FALSE) # weight and BMI
cor.test(x = merged_nhanes$BMXHT, merged_nhanes$BMXBMI, method = c("spearman"), exact = FALSE) # height and BMI
plot(x = merged_nhanes$BMXWT, y = merged_nhanes$BMXHT)
# Let us compute the Pearson's correlation coefficient and test.
cor.test(x = merged_nhanes$BMXWT, y = merged_nhanes$BMXHT, method = c("pearson")) # weight and height circumference
plot(x = merged_nhanes$BMXWT, y = merged_nhanes$BMXHT)
# Let us compute the Pearson's correlation coefficient and test.
cor.test(x = merged_nhanes$BMXWT, y = merged_nhanes$BMXHT, method = c("pearson")) # weight and height circumference
plot(x = merged_nhanes$BMXWT, y = merged_nhanes$BMXHT)
cor.test(x = merged_nhanes$BMXWT, y = merged_nhanes$BMXWAIST, method = c("pearson")) # weight and waist circumference
plot(x = merged_nhanes$BMXWT, y = merged_nhanes$BMXWAIST)
cor.test(x = merged_nhanes$BMXHT, y = merged_nhanes$BMXWAIST, method = c("pearson")) # height and waist circumference
plot(x = merged_nhanes$BMXHT, y = merged_nhanes$BMXWAIST)
cor.test(x = merged_nhanes$BMXWT, y = merged_nhanes$BMXBMI, method = c("pearson")) # weight and BMI
plot(x = merged_nhanes$BMXWT, y = merged_nhanes$BMXBMI)
cor.test(x = merged_nhanes$BMXHT, y = merged_nhanes$BMXBMI, method = c("pearson")) # height and BMI
plot(x = merged_nhanes$BMXHT, y = merged_nhanes$BMXBMI)
plot(merged_nhanes$BMXWT, merged_nhanes$BMXHT,
col = "steelblue",
pch = 19,       # solid circles
cex = 1.2,      # slightly bigger points
xlab = "Weight (kg)",
ylab = "Height (cm)",
main = "Scatterplot of Weight vs Height",
las = 1)
plot(merged_nhanes$BMXWT, merged_nhanes$BMXHT,
col = "steelblue",
xlab = "Weight (kg)",
ylab = "Height (cm)",
main = "Scatterplot of Weight vs Height",
las = 1)
plot(merged_nhanes$BMXWT, merged_nhanes$BMXHT,
col = "steelblue",
xlab = "Weight (kg)",
ylab = "Height (cm)",
main = "Scatterplot of weight vs height")
# Let us compute the Pearson's correlation coefficient and test.
# We also plot the each pair of variables in a scatter plot.
cor.test(x = merged_nhanes$BMXWT, y = merged_nhanes$BMXHT, method = c("pearson")) # weight and height circumference
plot(merged_nhanes$BMXWT, merged_nhanes$BMXHT,
col = "steelblue",
xlab = "Weight (kg)",
ylab = "Height (cm)",
main = "Scatterplot of weight vs height")
cor.test(x = merged_nhanes$BMXWT, y = merged_nhanes$BMXWAIST, method = c("pearson")) # weight and waist circumference
plot(x = merged_nhanes$BMXWT, y = merged_nhanes$BMXWAIST,
col = "steelblue",
xlab = "Weight (kg)",
ylab = "Waist circumference (cm)",
main = "Scatterplot of weight vs waist circumference")
cor.test(x = merged_nhanes$BMXHT, y = merged_nhanes$BMXWAIST, method = c("pearson")) # height and waist circumference
plot(x = merged_nhanes$BMXHT, y = merged_nhanes$BMXWAIST,
col = "steelblue",
xlab = "Height (cm)",
ylab = "Waist circumference (cm)",
main = "Scatterplot of height vs waist circumference")
cor.test(x = merged_nhanes$BMXWT, y = merged_nhanes$BMXBMI, method = c("pearson")) # weight and BMI
plot(x = merged_nhanes$BMXWT, y = merged_nhanes$BMXBMI,
col = "steelblue",
xlab = "Weight (kg)",
ylab = "Body Mass Index (kg/m²)",
main = "Scatterplot of weight vs BMI")
cor.test(x = merged_nhanes$BMXHT, y = merged_nhanes$BMXBMI, method = c("pearson")) # height and BMI
plot(x = merged_nhanes$BMXHT, y = merged_nhanes$BMXBMI,
col = "steelblue",
xlab = "Height (cm)",
ylab = "Body Mass Index (kg/m²)",
main = "Scatterplot of height vs BMI")
# We quickly check the distribution of weight, BMI, height and waist circumference using Q-Q-plots
qqnorm(y = merged_nhanes$BMXWT)
qqnorm(y = merged_nhanes$BMXHT)
qqnorm(y = merged_nhanes$BMXBMI)
qqnorm(y = merged_nhanes$BMXWAIST)
# Let us compute the Pearson's correlation coefficient and test.
# We also plot the each pair of variables in a scatter plot.
cor.test(x = merged_nhanes$BMXWT, y = merged_nhanes$BMXHT, method = c("pearson")) # weight and height circumference
plot(merged_nhanes$BMXWT, merged_nhanes$BMXHT,
col = "steelblue",
xlab = "Weight (kg)",
ylab = "Height (cm)",
main = "Scatterplot of weight vs height")
cor.test(x = merged_nhanes$BMXWT, y = merged_nhanes$BMXWAIST, method = c("pearson")) # weight and waist circumference
plot(x = merged_nhanes$BMXWT, y = merged_nhanes$BMXWAIST,
col = "steelblue",
xlab = "Weight (kg)",
ylab = "Waist circumference (cm)",
main = "Scatterplot of weight vs waist circumference")
cor.test(x = merged_nhanes$BMXHT, y = merged_nhanes$BMXWAIST, method = c("pearson")) # height and waist circumference
plot(x = merged_nhanes$BMXHT, y = merged_nhanes$BMXWAIST,
col = "steelblue",
xlab = "Height (cm)",
ylab = "Waist circumference (cm)",
main = "Scatterplot of height vs waist circumference")
cor.test(x = merged_nhanes$BMXWT, y = merged_nhanes$BMXBMI, method = c("pearson")) # weight and BMI
plot(x = merged_nhanes$BMXWT, y = merged_nhanes$BMXBMI,
col = "steelblue",
xlab = "Weight (kg)",
ylab = "Body Mass Index (kg/m^2)",
main = "Scatterplot of weight vs BMI")
cor.test(x = merged_nhanes$BMXHT, y = merged_nhanes$BMXBMI, method = c("pearson")) # height and BMI
plot(x = merged_nhanes$BMXHT, y = merged_nhanes$BMXBMI,
col = "steelblue",
xlab = "Height (cm)",
ylab = "Body Mass Index (kg/m^2)",
main = "Scatterplot of height vs BMI")
# Let us compute the Spearman's correlation coefficient and test.
# We also plot the each pair of variables in a scatter plot.
cor.test(x = merged_nhanes$BMXWT, y = merged_nhanes$BMXHT, method = c("spearman"), exact = FALSE) # weight and height circumference
plot(merged_nhanes$BMXWT, merged_nhanes$BMXHT,
col = "steelblue",
xlab = "Weight (kg)",
ylab = "Height (cm)",
main = "Scatterplot of weight vs height")
cor.test(x = merged_nhanes$BMXWT, y = merged_nhanes$BMXWAIST, method = c("spearman"), exact = FALSE) # weight and waist circumference
plot(x = merged_nhanes$BMXWT, y = merged_nhanes$BMXWAIST,
col = "steelblue",
xlab = "Weight (kg)",
ylab = "Waist circumference (cm)",
main = "Scatterplot of weight vs waist circumference")
cor.test(x = merged_nhanes$BMXHT, y = merged_nhanes$BMXWAIST, method = c("spearman"), exact = FALSE) # height and waist circumference
plot(x = merged_nhanes$BMXHT, y = merged_nhanes$BMXWAIST,
col = "steelblue",
xlab = "Height (cm)",
ylab = "Waist circumference (cm)",
main = "Scatterplot of height vs waist circumference")
cor.test(x = merged_nhanes$BMXWT, y = merged_nhanes$BMXBMI, method = c("spearman"), exact = FALSE) # weight and BMI
plot(x = merged_nhanes$BMXWT, y = merged_nhanes$BMXBMI,
col = "steelblue",
xlab = "Weight (kg)",
ylab = "Body Mass Index (kg/m^2)",
main = "Scatterplot of weight vs BMI")
cor.test(x = merged_nhanes$BMXHT, y = merged_nhanes$BMXBMI, method = c("spearman"), exact = FALSE) # height and BMI
plot(x = merged_nhanes$BMXHT, y = merged_nhanes$BMXBMI,
col = "steelblue",
xlab = "Height (cm)",
ylab = "Body Mass Index (kg/m^2)",
main = "Scatterplot of height vs BMI")
# Load the merged_nhanes CSV file
merged_nhanes <- read.csv("C:/GitHub/rforphysicians/data_sets/merged_nhanes.csv")
# Load the merged_nhanes_with_mort CSV file
merged_nhanes_with_mort <- read.csv("C:/GitHub/rforphysicians/data_sets/merged_nhanes_with_mort.csv")
# Load the merged_nhanes CSV file
merged_nhanes <- read.csv("C:/GitHub/rforphysicians/data_sets/merged_nhanes.csv")
# Load the merged_nhanes_with_mort CSV file
merged_nhanes_with_mort <- read.csv("C:/GitHub/rforphysicians/data_sets/merged_nhanes_with_mort.csv")
# Let us have a look at the systolic blood pressure in our data set
hist(merged_nhanes$BPXSY1,
col = "steelblue",
xlab = "Weight (kg)",
ylab = "Height (cm)",
main = "Scatterplot of weight vs height")
# Let us have a look at the systolic blood pressure in our data set
hist(merged_nhanes$BPXSY1,
col = "steelblue",
xlab = "Count",
ylab = "Stystolic blood pressure (1st reading) [mmHg]",
main = "Histogram of systolic blood pressure")
qqnorm(merged_nhanes$BPXSY1,
col = "steelblue",
xlab = "Count",
ylab = "Stystolic blood pressure (1st reading) [mmHg]",
main = "Histogram of systolic blood pressure")
# Let us have a look at the systolic blood pressure in our data set
hist(merged_nhanes$BPXSY1,
col = "steelblue",
xlab = "Count",
ylab = "Stystolic blood pressure (1st reading) [mmHg]",
main = "Histogram of systolic blood pressure")
qqnorm(merged_nhanes$BPXSY1,
col = "steelblue",
xlab = "Normal quantiles",
ylab = "Stystolic blood pressure (1st reading) [mmHg]",
main = "Q-Q-plot of systolic blood pressure")
merged_nhanes$RIAGENDR
# Since the distribution is only slightly right-skewed, and we have a lot of data, we run a t-test to compare both groups (males and females)
females <- merged_nhanes$BPXSY1[merged_nhanes$RIAGENDR == "Female",]
merged_nhanes$RIAGENDR == "Female"
# Since the distribution is only slightly right-skewed, and we have a lot of data, we run a t-test to compare both groups (males and females)
females <- merged_nhanes[merged_nhanes$RIAGENDR == "Female",]$BPXSY1
males <- merged_nhanes[merged_nhanes$RIAGENDR == "Male",]$BPXSY1
t.test(x = females, y = males)
t.test(x = females, y = males,
alternative = c("two.sided"))
# Let us have a look at the waist circumference in our data set
hist(merged_nhanes$BMXWAIST,
col = "coral",
xlab = "Count",
ylab = "Stystolic blood pressure (1st reading) [mmHg]",
main = "Histogram of systolic blood pressure")
qqnorm(merged_nhanes$BMXWAIST,
col = "coral",
xlab = "Normal quantiles",
ylab = "Stystolic blood pressure (1st reading) [mmHg]",
main = "Q-Q-plot of systolic blood pressure")
# Let us have a look at the waist circumference in our data set
hist(merged_nhanes$DMDHRAGE,
col = "coral",
xlab = "Count",
ylab = "Stystolic blood pressure (1st reading) [mmHg]",
main = "Histogram of systolic blood pressure")
qqnorm(merged_nhanes$DMDHRAGE,
col = "coral",
xlab = "Normal quantiles",
ylab = "Stystolic blood pressure (1st reading) [mmHg]",
main = "Q-Q-plot of systolic blood pressure")
# Let us have a look at the waist circumference in our data set
hist(merged_nhanes$DMDHRAGE,
col = "coral",
xlab = "Count",
ylab = "Stystolic blood pressure (1st reading) [mmHg]",
main = "Histogram of systolic blood pressure")
# Let us have a look at the systolic blood pressure in our data set
hist(merged_nhanes$BPXSY1,
col = "steelblue",
xlab = "Stystolic blood pressure (1st reading) [mmHg]",
ylab = "Count",
main = "Histogram of systolic blood pressure")
qqnorm(merged_nhanes$BPXSY1,
col = "steelblue",
xlab = "Normal quantiles",
ylab = "Stystolic blood pressure (1st reading) [mmHg]",
main = "Q-Q-plot of systolic blood pressure")
# Since the distribution is only slightly right-skewed, and we have a lot of data, we run a t-test to compare both groups (males and females)
females <- merged_nhanes[merged_nhanes$RIAGENDR == "Female",]$BPXSY1
males <- merged_nhanes[merged_nhanes$RIAGENDR == "Male",]$BPXSY1
t.test(x = females, y = males,
alternative = c("two.sided"))
# Let us have a look at the waist circumference in our data set
hist(merged_nhanes$DMDHRAGE,
col = "coral",
xlab = "Count",
ylab = "Stystolic blood pressure (1st reading) [mmHg]",
main = "Histogram of systolic blood pressure")
qqnorm(merged_nhanes$DMDHRAGE,
col = "coral",
xlab = "Normal quantiles",
ylab = "Stystolic blood pressure (1st reading) [mmHg]",
main = "Q-Q-plot of systolic blood pressure")
# Let us have a look at the waist circumference in our data set
hist(merged_nhanes$DMDHRAGE,
col = "coral",
xlab = "Count",
ylab = "Stystolic blood pressure (1st reading) [mmHg]",
main = "Histogram of systolic blood pressure")
qqnorm(merged_nhanes$DMDHRAGE,
col = "coral",
xlab = "Normal quantiles",
ylab = "Stystolic blood pressure (1st reading) [mmHg]",
main = "Q-Q-plot of systolic blood pressure")
merged_nhanes$DMDHRAGE
# This time, the distribution is definitely non normal, so we run a Wilcoxon test to compare the smokers and non smokers
smokers <- merged_nhanes[merged_nhanes$SMQ020 == "Yes",]$DMDHRAGE
nonsmokers <- merged_nhanes[merged_nhanes$SMQ020 == "No",]$DMDHRAGE
wilcox.test(x = smokers, y = nonsmokers,
alternative = c("two.sided"))
# Let us visualize the contingency table
(tab <- table(merged_nhanes$SMQ020, merged_nhanes$RIAGENDR))
# First, let us select the smokers and non-smokers (and get rid of the categories 'Don't know' and 'Refused')
smoke <- merged_nhanes[merged_nhanes$SMQ020 %in% c("Yes", "No"),]
smoke$SMQ020
# Let us visualize the contingency table
(tab <- table(smoke$SMQ020, smoke$DMDHRMAR))
smoke$DMDHRMAR <- ifelse(smoke$DMDHRMAR == "Married", "Married", "Not married")
# Let us visualize the contingency table
(tab <- table(smoke$SMQ020, smoke$DMDHRMAR))
# What are the expected cell counts in this case?
chisq <- chisq.test(tab)
round(chisq$expected,2)
# Since the expected counts are way above 5, we use a chi-square test to compare the proportions
chisq.test(tab)
merged_nhanes$SMQ680
merged_nhanes$SMQ020
library(nhanesA)
install.packages("nhanesA")
library(nhanesA)
nhanesCodebook(SMQ_G, SMQ680)
nhanesCodebook("SMQ_G", "SMQ680")
nhanesCodebook("SMQ_G", "SMQ040")
nhanesCodebook("SMQ_G", "SMQ050")
nhanesCodebook("SMQ_G", "SMQ060")
nhanesCodebook("SMQ_G", "SMQ050Q")
nhanesCodebook("SMQ_G", "SMQ020")
nhanesCodebook("SMQ_G", "SMQ040")
nhanesCodebook("SMQ_G", "SMQ050Q")
nhanesCodebook("SMQ_G", "SMD030")
nhanesCodebook("SMQ_G", "SMD070")
nhanesCodebook("SMQ_G", "SMQ680")
nhanesCodebook("SMQ_G", "SMQ690")
nhanesCodebook("SMQ_G", "SMQ700")
nhanesCodebook("SMQ_G", "SMQ710")
View(merged_nhanes)
nhanesCodebook("SMQ_G", "SMQ660")
nhanesCodebook("SMQ_G", "SMQ630")
nhanesCodebook("SMQ_G", "SMQ664M")
nhanesCodebook("SMQ_G", "SMQ664C")
nhanesCodebook("SMQ_G", "SMQ670")
merged_nhanes$SMQ670
nhanesCodebook("SMQ_G", "SMQ055")
nhanesCodebook("SMQ_G", "SMD055")
nhanesCodebook("SMQ_G", "SMD057")
nhanesCodebook("SMQ_G", "SMQ07)
nhanesCodebook("SMQ_G", "SMQ077)
nhanesCodebook("SMQ_G", "SMQ077")
library()
library(nhanesA)
library(nhanesA)
nhanesCodebook(SMQ_G, SMD660)
nhanesCodebook(SMQ, SMD660)
library(nhanes)
library(nhanesA)
nhanesCodebook(SMQ, SMD660)
library(nhanesA)
nhanesCodebook('SMQ', 'SMD660')
library(nhanesA)
nhanesCodebook('SMQ_G', 'SMD660')
library(nhanesA)
nhanesCodebook('SMQ_G', 'SMQ020')
library(nhanesA)
# An example here
nhanesCodebook('SMQ_G', 'SMQ020')
nhanesCodebook('SMQ_G', 'SMQ020')
nhanesCodebook('SMQ_G', 'SMQ040')
nhanesCodebook('SMQ_G', 'SMQ050Q')
nhanesCodebook('SMQ_G', 'SMD030')
nhanesCodebook('SMQ_G', 'SMD055')
nhanesCodebook('SMQ_G', 'SMD057')
nhanesCodebook('SMQ_G', 'SMQ077')
nhanesCodebook('SMQ_G', 'SMD660')
nhanesCodebook('SMQ_G', 'SMQ670')
nhanesCodebook('SMQ_G', 'SMQ050Q')
nhanesCodebook('SMQ_G', 'SMQ050U')
# Load the merged_nhanes CSV file
merged_nhanes <- read.csv("C:/GitHub/rforphysicians/data_sets/merged_nhanes.csv")
# Load the merged_nhanes_with_mort CSV file
merged_nhanes_with_mort <- read.csv("C:/GitHub/rforphysicians/data_sets/merged_nhanes_with_mort.csv")
merged_nhanes$SMQ050Q
merged_nhanes$SMQ050U
merged_nhanes$SMQ050U
nhanesCodebook('SMQ_G', 'SMQ050U')
nhanesCodebook('SMQ_G', 'SMQ0641')
nhanesCodebook('SMD_G', 'SMQ0641')
nhanesCodebook('SMQ_G', 'SMD0641')
nhanesCodebook('SMQ_G', 'SMD641')
nhanesCodebook('SMQ_G', 'SMQ621')
nhanesCodebook('SMQ_G', 'SMD100BR')
merged_nhanes$SMD100BR
nhanesCodebook('SMQ_G', 'SMD100BR')
nhanesCodebook('BMX_G', 'BMXHIP')
merged_nhanes$BMXHIP
merged_nhanes$BPXPULS
nhanesCodebook('BPX_G', 'BPXPULS')
nhanesCodebook('BPX_G', 'BPXPLS')
nhanesCodebook('BPX_G', 'BPXPTY')
nhanesCodebook('BPX_G', 'BPAARM')
nhanesCodebook('BPX_G', 'PEASCST1')
nhanesCodebook('BPX_G', 'BPXCHR')
nhanesCodebook('BPX_G', 'BPQ150C')
nhanesCodebook('BPX_G', 'BPQ150D')
nhanesCodebook('DEMO_G', 'RIDAGEYR')
nhanesCodebook('DEMO_G', 'RIAGENDR')
nhanesCodebook('DEMO_G', 'DMDHHSIZ')
nhanesCodebook('DEMO_G', 'DMDHHSZA')
nhanesCodebook('DEMO_G', 'DMDHRAGE')
nhanesCodebook('DEMO_G', 'DMDHRMAR')
nhanesCodebook('DEMO_G', 'DMDHRGND')
nhanesCodebook('DEMO_G', 'AIALANGA')
merged_nhanes$RIDEXPRG
nhanesCodebook('DEMO_G', 'RIDAGEYR')
nhanesCodebook('DEMO_G', 'RIDRETH1')
nhanesCodebook('DEMO_G', 'MIALANG')
nhanesCodebook('DEMO_G', 'AIALANGA')
saveRDS(merged_nhanes_with_mort, "merged_nhanes_with_mort.rds")
getwd()
setwd("C:/GitHub/rforphysicians/docs")
saveRDS(merged_nhanes_with_mort, "merged_nhanes_with_mort.rds")
save(merged_nhanes, "merged_nhanes.R")
save(merged_nhanes, file = "merged_nhanes.R")
# We define the age groups
merged_nhanes <- merged_nhanes %>%
filter(!is.na(RIDAGEYR)) %>%
mutate(age_group = cut(RIDAGEYR, breaks = seq(10, 80, 10)))  # Define age groups
knitr::opts_chunk$set(
echo = TRUE,
warning = FALSE,
message = FALSE,
fig.height = 5,
fig.width = 6,
eval = TRUE
)
library(tidyverse)
# We define the age groups
merged_nhanes <- merged_nhanes %>%
filter(!is.na(RIDAGEYR)) %>%
mutate(age_group = cut(RIDAGEYR, breaks = seq(10, 80, 10)))  # Define age groups
merged_nhanes$age_group
head(merged_nhanes$age_group)
# We define the age groups
merged_nhanes <- merged_nhanes %>%
mutate(AGE_GROUP = cut(RIDAGEYR, breaks = seq(10, 80, 10)))
head(merged_nhanes$AGE_GROUP)
# Let us have a look at the mean BMI for those groups
merged_nhanes %>%
group_by(AGE_GROUP) %>%
summarise(
n = n(),
mean_BMXBMI = mean(BMXBMI, na.rm = TRUE)
)
# Let us now test the means using a one-way ANOVA
oneway.test(BMXBMI ~ AGE_GROUP, data = merged_nhanes)
# First, let us select the pipe and cigar smokers
smoke <- merged_nhanes[merged_nhanes$SMQ020 %in% c("Yes", "No"),]
smoke$DMDHRMAR <- ifelse(smoke$DMDHRMAR == "Married", "Married", "Not married")
# Let us visualize the contingency table
(tab <- table(smoke$SMQ020, smoke$DMDHRMAR))
# What are the expected cell counts in this case?
chisq <- chisq.test(tab)
round(chisq$expected,2)
# Since the expected counts are way above 5, we use a chi-square test to compare the proportions
chisq.test(tab)
